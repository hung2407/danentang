
[2025-05-21 00:24:36] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:25:22] === VNPAY IPN CALLBACK RECEIVED ===
{
  "query": {},
  "headers": {
    "user-agent": "PostmanRuntime/7.44.0",
    "accept": "*/*",
    "postman-token": "55f1fb24-c397-4242-b6c4-691489525ffa",
    "host": "192.168.0.101:3000",
    "accept-encoding": "gzip, deflate, br",
    "connection": "keep-alive"
  },
  "ip": "::ffff:192.168.0.101"
}

[2025-05-21 00:25:22] Original hash from VNPay:

[2025-05-21 00:25:23] Hash type:
SHA512

[2025-05-21 00:25:23] IPN raw params (before sorting):
{}

[2025-05-21 00:25:23] IPN sorted params (method 1):
{}

[2025-05-21 00:25:23] IPN sorted params (method 2):
{}

[2025-05-21 00:25:23] IPN Verification signData (method 1):

[2025-05-21 00:25:23] IPN Verification signData (method 2):

[2025-05-21 00:25:23] IPN Expected hash (method 1):
40158e44af7ffc82ccb7a03f7e45e5a8dd012ef6f2951f9fabc8e88ab21908d1ea299a58f95512900505bc4ab43f6d6171ddad5f0c5a5be46f0701b201ec39a3

[2025-05-21 00:25:23] IPN Expected hash (method 2):
40158e44af7ffc82ccb7a03f7e45e5a8dd012ef6f2951f9fabc8e88ab21908d1ea299a58f95512900505bc4ab43f6d6171ddad5f0c5a5be46f0701b201ec39a3

[2025-05-21 00:25:23] IPN Received hash:

[2025-05-21 00:25:23] Signature verification failed with both methods!
{
  "expected1": "40158e44af7ffc82ccb7a03f7e45e5a8dd012ef6f2951f9fabc8e88ab21908d1ea299a58f95512900505bc4ab43f6d6171ddad5f0c5a5be46f0701b201ec39a3",
  "expected2": "40158e44af7ffc82ccb7a03f7e45e5a8dd012ef6f2951f9fabc8e88ab21908d1ea299a58f95512900505bc4ab43f6d6171ddad5f0c5a5be46f0701b201ec39a3"
}

[2025-05-21 00:27:06] === VNPAY IPN CALLBACK RECEIVED ===
{
  "query": {
    "vnp_Amount": "1000000",
    "vnp_Command": "pay",
    "...": "",
    "vnp_SecureHash": "xxxx\n"
  },
  "headers": {
    "user-agent": "PostmanRuntime/7.44.0",
    "accept": "*/*",
    "postman-token": "fa832243-e79f-4ea5-97bf-5001212e3f99",
    "host": "192.168.0.101:3000",
    "accept-encoding": "gzip, deflate, br",
    "connection": "keep-alive"
  },
  "ip": "::ffff:192.168.0.101"
}

[2025-05-21 00:27:06] Original hash from VNPay:
xxxx


[2025-05-21 00:27:06] Hash type:
SHA512

[2025-05-21 00:27:06] IPN raw params (before sorting):
{
  "vnp_Amount": "1000000",
  "vnp_Command": "pay",
  "...": ""
}

[2025-05-21 00:27:06] IPN sorted params (method 1):
{
  "...": "",
  "vnp_Amount": "1000000",
  "vnp_Command": "pay"
}

[2025-05-21 00:27:06] IPN sorted params (method 2):
{
  "...": "",
  "vnp_Amount": "1000000",
  "vnp_Command": "pay"
}

[2025-05-21 00:27:06] IPN Verification signData (method 1):
...=&vnp_Amount=1000000&vnp_Command=pay

[2025-05-21 00:27:06] IPN Verification signData (method 2):
...=&vnp_Amount=1000000&vnp_Command=pay

[2025-05-21 00:27:06] IPN Expected hash (method 1):
d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef

[2025-05-21 00:27:06] IPN Expected hash (method 2):
d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef

[2025-05-21 00:27:06] IPN Received hash:
xxxx


[2025-05-21 00:27:06] Signature verification failed with both methods!
{
  "received": "xxxx\n",
  "expected1": "d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef",
  "expected2": "d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef"
}

[2025-05-21 00:32:57] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:32:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:33:17] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:33:19] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:36:54] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:37:30] === VNPAY IPN CALLBACK RECEIVED ===
{
  "query": {
    "vnp_Amount": "1000000",
    "vnp_Command": "pay",
    "...": "",
    "vnp_SecureHash": "xxxx\n"
  },
  "headers": {
    "user-agent": "PostmanRuntime/7.44.0",
    "accept": "*/*",
    "postman-token": "19606db6-718c-443e-8878-7c58ca611ecd",
    "host": "192.168.0.101:3000",
    "accept-encoding": "gzip, deflate, br",
    "connection": "keep-alive"
  },
  "ip": "::ffff:192.168.0.101"
}

[2025-05-21 00:37:30] Original hash from VNPay:
xxxx


[2025-05-21 00:37:30] Cleaned hash from VNPay:
xxxx

[2025-05-21 00:37:30] Hash type:
SHA512

[2025-05-21 00:37:30] IPN raw params (before sorting):
{
  "vnp_Amount": "1000000",
  "vnp_Command": "pay",
  "...": ""
}

[2025-05-21 00:37:30] IPN sorted params (method 1):
{
  "...": "",
  "vnp_Amount": "1000000",
  "vnp_Command": "pay"
}

[2025-05-21 00:37:30] IPN sorted params (method 2):
{
  "...": "",
  "vnp_Amount": "1000000",
  "vnp_Command": "pay"
}

[2025-05-21 00:37:30] IPN Verification signData (method 1):
...=&vnp_Amount=1000000&vnp_Command=pay

[2025-05-21 00:37:30] IPN Verification signData (method 2):
...=&vnp_Amount=1000000&vnp_Command=pay

[2025-05-21 00:37:30] IPN Expected hash (method 1):
d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef

[2025-05-21 00:37:30] IPN Expected hash (method 2):
d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef

[2025-05-21 00:37:30] IPN Received hash:
xxxx

[2025-05-21 00:37:30] IPN Verification signData (method 3):
vnp_Amount=1000000&vnp_Command=pay

[2025-05-21 00:37:30] IPN Expected hash (method 3):
acdb325d470733cb2a591f8e6e06efccbabc23d7dbb4884ad3cb13f23f53e240fccab3875bdcd6a859ade0e1e070c034e5b8f0e28095b97ffcbdb7e28d7f5a6c

[2025-05-21 00:37:30] Signature verification failed with all methods!
{
  "received": "xxxx",
  "expected1": "d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef",
  "expected2": "d66729d75b2413358d9009f1760d725e9fade1c0255a0514cba46afae50c5edd9d97db5936e1f248ec2dbe6e222bbd5cbf674d4fe44c47f1a654f7c46abd70ef",
  "expected3": "acdb325d470733cb2a591f8e6e06efccbabc23d7dbb4884ad3cb13f23f53e240fccab3875bdcd6a859ade0e1e070c034e5b8f0e28095b97ffcbdb7e28d7f5a6c"
}

[2025-05-21 00:38:35] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:38:42] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "148",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 00:38:42] Booking check result:
{
  "found": true,
  "bookingId": "148"
}

[2025-05-21 00:38:42] Created payment record:
{
  "paymentId": 173,
  "bookingId": "148",
  "amount": 4800000
}

[2025-05-21 00:38:42] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "003842148",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521003842",
  "vnp_BankCode": ""
}

[2025-05-21 00:38:42] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521003842",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "003842148",
  "vnp_Version": "2.1.0"
}

[2025-05-21 00:38:42] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521003842&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=003842148&vnp_Version=2.1.0

[2025-05-21 00:38:42] VNPay generated signature:
ff1a87ada88cdde4d8f199e0d65751de4e7726741a9fe0b0b71a791977b179e89edf5b5b4d181726840b8024243104420c41995bdc05464d96f673046c256602

[2025-05-21 00:38:42] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521003842&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=003842148&vnp_Version=2.1.0&vnp_SecureHash=ff1a87ada88cdde4d8f199e0d65751de4e7726741a9fe0b0b71a791977b179e89edf5b5b4d181726840b8024243104420c41995bdc05464d96f673046c256602

[2025-05-21 00:38:42] Updated payment record with reference_id:
{
  "paymentId": 173,
  "orderId": "003842148"
}

[2025-05-21 00:38:42] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521003842&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=003842148&vnp_Version=2.1.0&vnp_SecureHash=ff1a87ada88cdde4d8f199e0d65751de4e7726741a9fe0b0b71a791977b179e89edf5b5b4d181726840b8024243104420c41995bdc05464d96f673046c256602"
}

[2025-05-21 00:46:37] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:46:37] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:47:30] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:48:40] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:50:09] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:50:22] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:50:36] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "148",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 00:50:36] Booking check result:
{
  "found": true,
  "bookingId": "148"
}

[2025-05-21 00:50:36] Created payment record:
{
  "paymentId": 174,
  "bookingId": "148",
  "amount": 4800000
}

[2025-05-21 00:50:36] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "005036148",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521005036",
  "vnp_BankCode": ""
}

[2025-05-21 00:50:36] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521005036",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "005036148",
  "vnp_Version": "2.1.0"
}

[2025-05-21 00:50:36] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005036&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005036148&vnp_Version=2.1.0

[2025-05-21 00:50:36] VNPay generated signature:
0c95618c989a515ce518c03a0e0830c508e22c2b79fdd65c886ce60f688166c406349901b3678295f3f17efa8cf148adc79e87f8d2a25276f7a08f0352daf4ad

[2025-05-21 00:50:36] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005036&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005036148&vnp_Version=2.1.0&vnp_SecureHash=0c95618c989a515ce518c03a0e0830c508e22c2b79fdd65c886ce60f688166c406349901b3678295f3f17efa8cf148adc79e87f8d2a25276f7a08f0352daf4ad

[2025-05-21 00:50:36] Updated payment record with reference_id:
{
  "paymentId": 174,
  "orderId": "005036148"
}

[2025-05-21 00:50:36] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005036&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005036148&vnp_Version=2.1.0&vnp_SecureHash=0c95618c989a515ce518c03a0e0830c508e22c2b79fdd65c886ce60f688166c406349901b3678295f3f17efa8cf148adc79e87f8d2a25276f7a08f0352daf4ad"
}

[2025-05-21 00:55:58] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 00:55:58] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 00:55:58] Created payment record:
{
  "paymentId": 176,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 00:55:58] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "005558149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521005558",
  "vnp_BankCode": ""
}

[2025-05-21 00:55:58] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521005558",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "005558149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 00:55:58] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005558&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005558149&vnp_Version=2.1.0

[2025-05-21 00:55:58] VNPay generated signature:
56321e73989bba5c08651df1a916fcac9dce9792f328e82ce94109c6737a478989c75ef2851b2a3a8d61abb56633d6057e0f512b56a54db13dc89d71b577bf86

[2025-05-21 00:55:58] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005558&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005558149&vnp_Version=2.1.0&vnp_SecureHash=56321e73989bba5c08651df1a916fcac9dce9792f328e82ce94109c6737a478989c75ef2851b2a3a8d61abb56633d6057e0f512b56a54db13dc89d71b577bf86

[2025-05-21 00:55:58] Updated payment record with reference_id:
{
  "paymentId": 176,
  "orderId": "005558149"
}

[2025-05-21 00:55:58] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005558&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005558149&vnp_Version=2.1.0&vnp_SecureHash=56321e73989bba5c08651df1a916fcac9dce9792f328e82ce94109c6737a478989c75ef2851b2a3a8d61abb56633d6057e0f512b56a54db13dc89d71b577bf86"
}

[2025-05-21 00:56:21] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 00:56:21] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 00:56:21] Created payment record:
{
  "paymentId": 177,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 00:56:21] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "005621149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521005621",
  "vnp_BankCode": ""
}

[2025-05-21 00:56:21] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521005621",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "005621149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 00:56:21] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005621&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005621149&vnp_Version=2.1.0

[2025-05-21 00:56:21] VNPay generated signature:
78751d817ad364ba45a26b2152359fe45b9d774b0732b70140a74ef300cf836b06f7222747eab31661cf89ba36b345e413b13cf0b431a72ff708613462a7ce6f

[2025-05-21 00:56:21] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005621&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005621149&vnp_Version=2.1.0&vnp_SecureHash=78751d817ad364ba45a26b2152359fe45b9d774b0732b70140a74ef300cf836b06f7222747eab31661cf89ba36b345e413b13cf0b431a72ff708613462a7ce6f

[2025-05-21 00:56:21] Updated payment record with reference_id:
{
  "paymentId": 177,
  "orderId": "005621149"
}

[2025-05-21 00:56:21] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005621&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005621149&vnp_Version=2.1.0&vnp_SecureHash=78751d817ad364ba45a26b2152359fe45b9d774b0732b70140a74ef300cf836b06f7222747eab31661cf89ba36b345e413b13cf0b431a72ff708613462a7ce6f"
}

[2025-05-21 00:57:11] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 00:57:11] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 00:57:11] Created payment record:
{
  "paymentId": 178,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 00:57:11] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "005711149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521005711",
  "vnp_BankCode": ""
}

[2025-05-21 00:57:11] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521005711",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "005711149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 00:57:11] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005711&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005711149&vnp_Version=2.1.0

[2025-05-21 00:57:11] VNPay generated signature:
692d8a0bd6c025fe4326ce19a11fb244629ddcd7ed08e94b2affffbb4dbb39c2a0e4014d454dc20c1bd4771d35bd54ae1dac2e56cebe19282aac281a691222ce

[2025-05-21 00:57:11] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005711&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005711149&vnp_Version=2.1.0&vnp_SecureHash=692d8a0bd6c025fe4326ce19a11fb244629ddcd7ed08e94b2affffbb4dbb39c2a0e4014d454dc20c1bd4771d35bd54ae1dac2e56cebe19282aac281a691222ce

[2025-05-21 00:57:11] Updated payment record with reference_id:
{
  "paymentId": 178,
  "orderId": "005711149"
}

[2025-05-21 00:57:11] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521005711&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=005711149&vnp_Version=2.1.0&vnp_SecureHash=692d8a0bd6c025fe4326ce19a11fb244629ddcd7ed08e94b2affffbb4dbb39c2a0e4014d454dc20c1bd4771d35bd54ae1dac2e56cebe19282aac281a691222ce"
}

[2025-05-21 00:58:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:58:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:58:59] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:58:59] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:24] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:25] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:25] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:25] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:46] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:46] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:47] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 00:59:47] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 01:01:23] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 01:01:28] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 01:02:20] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 01:02:25] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 01:02:25] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 01:02:25] Created payment record:
{
  "paymentId": 179,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 01:02:25] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "010225149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521010225",
  "vnp_BankCode": ""
}

[2025-05-21 01:02:25] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521010225",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "010225149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 01:02:25] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010225&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010225149&vnp_Version=2.1.0

[2025-05-21 01:02:25] VNPay generated signature:
95a8f6b3c9c630a745e528fb8f41cf2a3b78ce2eb71149426d525720aa948a4cf256d99344ff9d43d5ae1a95d651d7ff17bbb313da8be317d1fc38ca68c7542b

[2025-05-21 01:02:25] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010225&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010225149&vnp_Version=2.1.0&vnp_SecureHash=95a8f6b3c9c630a745e528fb8f41cf2a3b78ce2eb71149426d525720aa948a4cf256d99344ff9d43d5ae1a95d651d7ff17bbb313da8be317d1fc38ca68c7542b

[2025-05-21 01:02:25] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 01:02:28] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 01:02:28] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 01:02:28] Created payment record:
{
  "paymentId": 180,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 01:02:28] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "010228149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521010228",
  "vnp_BankCode": ""
}

[2025-05-21 01:02:28] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521010228",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "010228149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 01:02:28] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010228&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010228149&vnp_Version=2.1.0

[2025-05-21 01:02:28] VNPay generated signature:
eaaeadf58d63a5429924638b73d3227091955242397382db02c5bf2511d40b8bba1c4fad013c82f7e245db5c2923f165b7303610758faec9a1e007262cbd9dad

[2025-05-21 01:02:28] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010228&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010228149&vnp_Version=2.1.0&vnp_SecureHash=eaaeadf58d63a5429924638b73d3227091955242397382db02c5bf2511d40b8bba1c4fad013c82f7e245db5c2923f165b7303610758faec9a1e007262cbd9dad

[2025-05-21 01:02:28] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 01:02:42] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 01:02:43] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 01:02:43] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 01:02:43] Created payment record:
{
  "paymentId": 181,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 01:02:43] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "010243149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521010243",
  "vnp_BankCode": ""
}

[2025-05-21 01:02:43] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521010243",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "010243149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 01:02:43] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010243&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010243149&vnp_Version=2.1.0

[2025-05-21 01:02:43] VNPay generated signature:
76b5d98d0493a9f26fda73c2a10a6581e4915b9b3022712dc4647f2baf1ac085a2315c4a8ddc170e3c91ce9d44c7e59ffe88b88c4561fb1d731c5cdcd5ac4fd9

[2025-05-21 01:02:43] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010243&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010243149&vnp_Version=2.1.0&vnp_SecureHash=76b5d98d0493a9f26fda73c2a10a6581e4915b9b3022712dc4647f2baf1ac085a2315c4a8ddc170e3c91ce9d44c7e59ffe88b88c4561fb1d731c5cdcd5ac4fd9

[2025-05-21 01:02:43] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 01:02:53] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "149",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 01:02:53] Booking check result:
{
  "found": true,
  "bookingId": "149"
}

[2025-05-21 01:02:53] Created payment record:
{
  "paymentId": 182,
  "bookingId": "149",
  "amount": 4800000
}

[2025-05-21 01:02:53] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "010253149",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521010253",
  "vnp_BankCode": ""
}

[2025-05-21 01:02:53] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521010253",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "010253149",
  "vnp_Version": "2.1.0"
}

[2025-05-21 01:02:53] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010253&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010253149&vnp_Version=2.1.0

[2025-05-21 01:02:53] VNPay generated signature:
631ae1bcecc6c85a8bd6fc20517daf1c924da5d861d85721b765363a8b81e09ad32892e7366629a8982f17ca2a3318a3a8ce313bfcda9bd5f1ff35787621513e

[2025-05-21 01:02:53] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010253&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010253149&vnp_Version=2.1.0&vnp_SecureHash=631ae1bcecc6c85a8bd6fc20517daf1c924da5d861d85721b765363a8b81e09ad32892e7366629a8982f17ca2a3318a3a8ce313bfcda9bd5f1ff35787621513e

[2025-05-21 01:02:53] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 01:03:29] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "150",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K15 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 01:03:29] Booking check result:
{
  "found": true,
  "bookingId": "150"
}

[2025-05-21 01:03:29] Created payment record:
{
  "paymentId": 184,
  "bookingId": "150",
  "amount": 4800000
}

[2025-05-21 01:03:29] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "010329150",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K15 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521010329",
  "vnp_BankCode": ""
}

[2025-05-21 01:03:29] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521010329",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "010329150",
  "vnp_Version": "2.1.0"
}

[2025-05-21 01:03:29] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010329&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010329150&vnp_Version=2.1.0

[2025-05-21 01:03:29] VNPay generated signature:
92b06de87229a7422e287a7a68ed64d66fe935582d38baeaca12337d83a4aa432b2e1393355eb8634b5375aa1d9658b61c6837d398cdfa8f2b4d6431fab62af6

[2025-05-21 01:03:29] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521010329&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=010329150&vnp_Version=2.1.0&vnp_SecureHash=92b06de87229a7422e287a7a68ed64d66fe935582d38baeaca12337d83a4aa432b2e1393355eb8634b5375aa1d9658b61c6837d398cdfa8f2b4d6431fab62af6

[2025-05-21 01:03:29] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 09:04:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:07:09] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:13:17] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "151",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:13:17] Booking check result:
{
  "found": true,
  "bookingId": "151"
}

[2025-05-21 09:13:17] Created payment record:
{
  "paymentId": 186,
  "bookingId": "151",
  "amount": 4800000
}

[2025-05-21 09:13:17] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "091317151",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521091317",
  "vnp_BankCode": ""
}

[2025-05-21 09:13:17] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521091317",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "091317151",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:13:17] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521091317&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=091317151&vnp_Version=2.1.0

[2025-05-21 09:13:17] VNPay generated signature:
7057629f1220dcbef4635a4fa207e0e5283fd6f8613d681c26ac05546022d98531283e9f187bb1d8e6d5f8af5e6a429bfb399ce7190cfed0a8cedd9995b1b327

[2025-05-21 09:13:17] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521091317&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=091317151&vnp_Version=2.1.0&vnp_SecureHash=7057629f1220dcbef4635a4fa207e0e5283fd6f8613d681c26ac05546022d98531283e9f187bb1d8e6d5f8af5e6a429bfb399ce7190cfed0a8cedd9995b1b327

[2025-05-21 09:13:17] Error creating VNPAY payment:
Error: Unknown column 'meta_data' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at createVnpayPayment (D:\Parking\backend\danentang\backend\controllers\paymentController.js:176:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 09:20:49] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "152",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:20:49] Booking check result:
{
  "found": true,
  "bookingId": "152"
}

[2025-05-21 09:20:49] Created payment record:
{
  "paymentId": 188,
  "bookingId": "152",
  "amount": 4800000
}

[2025-05-21 09:20:49] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "092049152",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521092049",
  "vnp_BankCode": ""
}

[2025-05-21 09:20:49] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521092049",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "092049152",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:20:49] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092049&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092049152&vnp_Version=2.1.0

[2025-05-21 09:20:49] VNPay generated signature:
7e92e50119439eda3635cc004c95888e29a1db3a59dbb08bae8d472db70f8c0846da8ae5e402529132729dde98081cc463afe9a838f6f32bc0adf5b0100b1090

[2025-05-21 09:20:49] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092049&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092049152&vnp_Version=2.1.0&vnp_SecureHash=7e92e50119439eda3635cc004c95888e29a1db3a59dbb08bae8d472db70f8c0846da8ae5e402529132729dde98081cc463afe9a838f6f32bc0adf5b0100b1090

[2025-05-21 09:20:49] Updated payment record with reference_id:
{
  "paymentId": 188,
  "orderId": "092049152",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:20:49] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092049&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092049152&vnp_Version=2.1.0&vnp_SecureHash=7e92e50119439eda3635cc004c95888e29a1db3a59dbb08bae8d472db70f8c0846da8ae5e402529132729dde98081cc463afe9a838f6f32bc0adf5b0100b1090"
}

[2025-05-21 09:26:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:27:05] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:29:09] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "152",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:29:09] Booking check result:
{
  "found": true,
  "bookingId": "152"
}

[2025-05-21 09:29:09] Created payment record:
{
  "paymentId": 189,
  "bookingId": "152",
  "amount": 4800000
}

[2025-05-21 09:29:09] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "092909152",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521092909",
  "vnp_BankCode": ""
}

[2025-05-21 09:29:09] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521092909",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "092909152",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:29:09] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092909&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092909152&vnp_Version=2.1.0

[2025-05-21 09:29:09] VNPay generated signature:
b0b04c7d79da8f77dd5f76c9c86c138b0659976ba71cf261e6df5708a9b5d79491eab8316919f2bfb97037171c5889954f4556f9883d97e39dfa48803277d9c0

[2025-05-21 09:29:09] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092909&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092909152&vnp_Version=2.1.0&vnp_SecureHash=b0b04c7d79da8f77dd5f76c9c86c138b0659976ba71cf261e6df5708a9b5d79491eab8316919f2bfb97037171c5889954f4556f9883d97e39dfa48803277d9c0

[2025-05-21 09:29:09] Updated payment record with reference_id:
{
  "paymentId": 189,
  "orderId": "092909152",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:29:09] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521092909&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=092909152&vnp_Version=2.1.0&vnp_SecureHash=b0b04c7d79da8f77dd5f76c9c86c138b0659976ba71cf261e6df5708a9b5d79491eab8316919f2bfb97037171c5889954f4556f9883d97e39dfa48803277d9c0"
}

[2025-05-21 09:49:16] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:49:41] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:53:53] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "154",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:53:53] Booking check result:
{
  "found": true,
  "bookingId": "154"
}

[2025-05-21 09:53:53] Created payment record:
{
  "paymentId": 192,
  "bookingId": "154",
  "amount": 4800000
}

[2025-05-21 09:53:53] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "095353154",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521095353",
  "vnp_BankCode": ""
}

[2025-05-21 09:53:53] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521095353",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "095353154",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:53:53] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095353&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095353154&vnp_Version=2.1.0

[2025-05-21 09:53:53] VNPay generated signature:
12935a4f6aeaa500b9ae0a5fd458a992296e04afc79a0e4025aa91f0b03bc1ba7a9cb4a94b714f34282c7077cc951593889032ace84c83f7233e850ebcf82b15

[2025-05-21 09:53:53] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095353&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095353154&vnp_Version=2.1.0&vnp_SecureHash=12935a4f6aeaa500b9ae0a5fd458a992296e04afc79a0e4025aa91f0b03bc1ba7a9cb4a94b714f34282c7077cc951593889032ace84c83f7233e850ebcf82b15

[2025-05-21 09:53:53] Updated payment record with reference_id:
{
  "paymentId": 192,
  "orderId": "095353154",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:53:53] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095353&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095353154&vnp_Version=2.1.0&vnp_SecureHash=12935a4f6aeaa500b9ae0a5fd458a992296e04afc79a0e4025aa91f0b03bc1ba7a9cb4a94b714f34282c7077cc951593889032ace84c83f7233e850ebcf82b15"
}

[2025-05-21 09:54:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:54:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:54:12] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 09:55:26] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "154",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:55:26] Booking check result:
{
  "found": true,
  "bookingId": "154"
}

[2025-05-21 09:55:26] Created payment record:
{
  "paymentId": 193,
  "bookingId": "154",
  "amount": 4800000
}

[2025-05-21 09:55:26] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "095526154",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521095526",
  "vnp_BankCode": ""
}

[2025-05-21 09:55:26] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521095526",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "095526154",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:55:26] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095526&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095526154&vnp_Version=2.1.0

[2025-05-21 09:55:26] VNPay generated signature:
9731d9781d44397ab86fbe78402b6f98e9c88389d19dbab86467c55de0fc4ef7411fb297cf36ece72bc622ae8765df81f649a7eedcbcf62e0eeb9af0d3babf82

[2025-05-21 09:55:26] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095526&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095526154&vnp_Version=2.1.0&vnp_SecureHash=9731d9781d44397ab86fbe78402b6f98e9c88389d19dbab86467c55de0fc4ef7411fb297cf36ece72bc622ae8765df81f649a7eedcbcf62e0eeb9af0d3babf82

[2025-05-21 09:55:26] Updated payment record with reference_id:
{
  "paymentId": 193,
  "orderId": "095526154",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:55:26] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095526&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095526154&vnp_Version=2.1.0&vnp_SecureHash=9731d9781d44397ab86fbe78402b6f98e9c88389d19dbab86467c55de0fc4ef7411fb297cf36ece72bc622ae8765df81f649a7eedcbcf62e0eeb9af0d3babf82"
}

[2025-05-21 09:55:34] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "154",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:55:34] Booking check result:
{
  "found": true,
  "bookingId": "154"
}

[2025-05-21 09:55:34] Created payment record:
{
  "paymentId": 194,
  "bookingId": "154",
  "amount": 4800000
}

[2025-05-21 09:55:34] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "095534154",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K01 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521095534",
  "vnp_BankCode": ""
}

[2025-05-21 09:55:34] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521095534",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "095534154",
  "vnp_Version": "2.1.0"
}

[2025-05-21 09:55:34] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095534&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095534154&vnp_Version=2.1.0

[2025-05-21 09:55:34] VNPay generated signature:
8591b071f09e6f06a73ed57d51f963c284bda67aacff3dc2fb828fa81e0bc78cdf1b77ff4ad0cd6ae70d1ee1c0ee9413d3a4dacecfd0ec345945839dc5ddf342

[2025-05-21 09:55:34] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095534&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095534154&vnp_Version=2.1.0&vnp_SecureHash=8591b071f09e6f06a73ed57d51f963c284bda67aacff3dc2fb828fa81e0bc78cdf1b77ff4ad0cd6ae70d1ee1c0ee9413d3a4dacecfd0ec345945839dc5ddf342

[2025-05-21 09:55:34] Updated payment record with reference_id:
{
  "paymentId": 194,
  "orderId": "095534154",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 09:55:34] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521095534&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K01+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=095534154&vnp_Version=2.1.0&vnp_SecureHash=8591b071f09e6f06a73ed57d51f963c284bda67aacff3dc2fb828fa81e0bc78cdf1b77ff4ad0cd6ae70d1ee1c0ee9413d3a4dacecfd0ec345945839dc5ddf342"
}

[2025-05-21 10:00:40] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:01:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:01:17] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:01:35] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:02:01] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "155",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:02:01] Booking check result:
{
  "found": true,
  "bookingId": "155"
}

[2025-05-21 10:02:01] Created payment record:
{
  "paymentId": 196,
  "bookingId": "155",
  "amount": 4800000
}

[2025-05-21 10:02:01] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "100201155",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "parkingapp://payment-result",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521100201",
  "vnp_BankCode": ""
}

[2025-05-21 10:02:01] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521100201",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K03+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "parkingapp%3A%2F%2Fpayment-result",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "100201155",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:02:01] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100201&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K03+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100201155&vnp_Version=2.1.0

[2025-05-21 10:02:01] VNPay generated signature:
e05b97610129899f2d6fe95d0d9e9d86cc86c6c27e33aee2385df26c9f08e33b8e5d2c338aaae19ce531a0ac2b2cd3664e0b6eeb4c3f5d3746473265dd20fe4c

[2025-05-21 10:02:01] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100201&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K03+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100201155&vnp_Version=2.1.0&vnp_SecureHash=e05b97610129899f2d6fe95d0d9e9d86cc86c6c27e33aee2385df26c9f08e33b8e5d2c338aaae19ce531a0ac2b2cd3664e0b6eeb4c3f5d3746473265dd20fe4c

[2025-05-21 10:02:01] Updated payment record with reference_id:
{
  "paymentId": 196,
  "orderId": "100201155",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:02:01] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100201&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K03+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=parkingapp%3A%2F%2Fpayment-result&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100201155&vnp_Version=2.1.0&vnp_SecureHash=e05b97610129899f2d6fe95d0d9e9d86cc86c6c27e33aee2385df26c9f08e33b8e5d2c338aaae19ce531a0ac2b2cd3664e0b6eeb4c3f5d3746473265dd20fe4c"
}

[2025-05-21 10:06:32] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:07:02] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:07:04] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:07:31] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:07:33] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:08:13] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:08:29] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:08:44] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:08:50] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "155",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:08:50] Booking check result:
{
  "found": true,
  "bookingId": "155"
}

[2025-05-21 10:08:50] Created payment record:
{
  "paymentId": 197,
  "bookingId": "155",
  "amount": 4800000
}

[2025-05-21 10:08:50] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "100850155",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521100850",
  "vnp_BankCode": ""
}

[2025-05-21 10:08:50] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521100850",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "100850155",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:08:50] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100850&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100850155&vnp_Version=2.1.0

[2025-05-21 10:08:50] VNPay generated signature:
f32d9b221bc76869c180b203130f0da2e6cec3935135df76c5f43435420bd7eda0779fbdc1bc23bedf0581e1f4df3ff43a09b479e99edd8ce083ae9780581cce

[2025-05-21 10:08:50] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100850&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100850155&vnp_Version=2.1.0&vnp_SecureHash=f32d9b221bc76869c180b203130f0da2e6cec3935135df76c5f43435420bd7eda0779fbdc1bc23bedf0581e1f4df3ff43a09b479e99edd8ce083ae9780581cce

[2025-05-21 10:08:50] Updated payment record with reference_id:
{
  "paymentId": 197,
  "orderId": "100850155",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:08:50] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100850&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100850155&vnp_Version=2.1.0&vnp_SecureHash=f32d9b221bc76869c180b203130f0da2e6cec3935135df76c5f43435420bd7eda0779fbdc1bc23bedf0581e1f4df3ff43a09b479e99edd8ce083ae9780581cce"
}

[2025-05-21 10:09:28] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:09:35] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "155",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:09:35] Booking check result:
{
  "found": true,
  "bookingId": "155"
}

[2025-05-21 10:09:35] Created payment record:
{
  "paymentId": 198,
  "bookingId": "155",
  "amount": 4800000
}

[2025-05-21 10:09:35] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "100935155",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521100935",
  "vnp_BankCode": ""
}

[2025-05-21 10:09:35] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521100935",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K03 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "100935155",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:09:35] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100935&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100935155&vnp_Version=2.1.0

[2025-05-21 10:09:35] VNPay generated signature:
58ce290e2d8b7c0f72f5be01372f6f3195f196cab7c0c19dbce1b48fb8d455e7f5fa70cd661e2dac643a3eea11d7b58c0cf2236d104d6e90614a190174431507

[2025-05-21 10:09:35] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100935&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100935155&vnp_Version=2.1.0&vnp_SecureHash=58ce290e2d8b7c0f72f5be01372f6f3195f196cab7c0c19dbce1b48fb8d455e7f5fa70cd661e2dac643a3eea11d7b58c0cf2236d104d6e90614a190174431507

[2025-05-21 10:09:35] Updated payment record with reference_id:
{
  "paymentId": 198,
  "orderId": "100935155",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:09:35] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521100935&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K03 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=100935155&vnp_Version=2.1.0&vnp_SecureHash=58ce290e2d8b7c0f72f5be01372f6f3195f196cab7c0c19dbce1b48fb8d455e7f5fa70cd661e2dac643a3eea11d7b58c0cf2236d104d6e90614a190174431507"
}

[2025-05-21 10:10:21] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "156",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:10:21] Booking check result:
{
  "found": true,
  "bookingId": "156"
}

[2025-05-21 10:10:21] Created payment record:
{
  "paymentId": 200,
  "bookingId": "156",
  "amount": 4800000
}

[2025-05-21 10:10:21] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "101021156",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521101021",
  "vnp_BankCode": ""
}

[2025-05-21 10:10:21] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521101021",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "101021156",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:10:21] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521101021&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=101021156&vnp_Version=2.1.0

[2025-05-21 10:10:21] VNPay generated signature:
e9b5640666e0e707416950683fa724562a17c1a913a095b5e53731d647031d752ca54f00e24a82139072cbe358df57c2ecc8c46f7f6ddd9747d63f312dcd821b

[2025-05-21 10:10:21] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521101021&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=101021156&vnp_Version=2.1.0&vnp_SecureHash=e9b5640666e0e707416950683fa724562a17c1a913a095b5e53731d647031d752ca54f00e24a82139072cbe358df57c2ecc8c46f7f6ddd9747d63f312dcd821b

[2025-05-21 10:10:21] Updated payment record with reference_id:
{
  "paymentId": 200,
  "orderId": "101021156",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:10:21] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521101021&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=101021156&vnp_Version=2.1.0&vnp_SecureHash=e9b5640666e0e707416950683fa724562a17c1a913a095b5e53731d647031d752ca54f00e24a82139072cbe358df57c2ecc8c46f7f6ddd9747d63f312dcd821b"
}

[2025-05-21 10:16:22] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:16:39] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:16:40] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:17:05] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:17:07] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:22:27] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:22:28] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "156",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:22:28] Booking check result:
{
  "found": true,
  "bookingId": "156"
}

[2025-05-21 10:22:28] Created payment record:
{
  "paymentId": 201,
  "bookingId": "156",
  "amount": 4800000
}

[2025-05-21 10:22:28] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "102228156",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521102228",
  "vnp_BankCode": ""
}

[2025-05-21 10:22:28] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521102228",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "102228156",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:22:28] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102228&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102228156&vnp_Version=2.1.0

[2025-05-21 10:22:28] VNPay generated signature:
864090a77de16153c832c923835e2c020913212d3f4e7d2de58b96acd0594d2125911ae3065668657c76149edc41404cd2c6f82925f96dfde92a3e029529c3c7

[2025-05-21 10:22:28] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102228&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102228156&vnp_Version=2.1.0&vnp_SecureHash=864090a77de16153c832c923835e2c020913212d3f4e7d2de58b96acd0594d2125911ae3065668657c76149edc41404cd2c6f82925f96dfde92a3e029529c3c7

[2025-05-21 10:22:28] Updated payment record with reference_id:
{
  "paymentId": 201,
  "orderId": "102228156",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:22:28] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102228&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh toán đặt chỗ K06 - 2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http://192.168.0.101:3000/api/payment/vnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102228156&vnp_Version=2.1.0&vnp_SecureHash=864090a77de16153c832c923835e2c020913212d3f4e7d2de58b96acd0594d2125911ae3065668657c76149edc41404cd2c6f82925f96dfde92a3e029529c3c7"
}

[2025-05-21 10:25:24] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:25:47] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:25:49] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:26:16] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:26:21] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:27:12] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:27:19] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "156",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:27:19] Booking check result:
{
  "found": true,
  "bookingId": "156"
}

[2025-05-21 10:27:19] Created payment record:
{
  "paymentId": 202,
  "bookingId": "156",
  "amount": 4800000
}

[2025-05-21 10:27:19] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "102719156",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521102719",
  "vnp_BankCode": ""
}

[2025-05-21 10:27:19] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521102719",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "102719156",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:27:19] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102719&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102719156&vnp_Version=2.1.0

[2025-05-21 10:27:19] VNPay generated signature:
ae1b1c3a98a87b2e11d1f8b4b2643eabcceaf7f23e37d16a670609594cd5f00179749595927da95952c01c037e1652482027da907f4e6c722e67665847538578

[2025-05-21 10:27:19] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102719&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102719156&vnp_Version=2.1.0&vnp_SecureHash=ae1b1c3a98a87b2e11d1f8b4b2643eabcceaf7f23e37d16a670609594cd5f00179749595927da95952c01c037e1652482027da907f4e6c722e67665847538578

[2025-05-21 10:27:19] Updated payment record with reference_id:
{
  "paymentId": 202,
  "orderId": "102719156",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:27:19] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102719&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102719156&vnp_Version=2.1.0&vnp_SecureHash=ae1b1c3a98a87b2e11d1f8b4b2643eabcceaf7f23e37d16a670609594cd5f00179749595927da95952c01c037e1652482027da907f4e6c722e67665847538578"
}

[2025-05-21 10:28:53] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "157",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:28:53] Booking check result:
{
  "found": true,
  "bookingId": "157"
}

[2025-05-21 10:28:53] Created payment record:
{
  "paymentId": 204,
  "bookingId": "157",
  "amount": 4800000
}

[2025-05-21 10:28:53] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "102853157",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521102853",
  "vnp_BankCode": ""
}

[2025-05-21 10:28:53] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521102853",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "102853157",
  "vnp_Version": "2.1.0"
}

[2025-05-21 10:28:53] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102853&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102853157&vnp_Version=2.1.0

[2025-05-21 10:28:53] VNPay generated signature:
e47b263dd635232dfdd9f6c2988760955ce360f7737e1c68fc95990325fc7e501b298b876f78a95f9dd2dfba33dfc5a3d0c5f0a6179917da2ef4412506d110c3

[2025-05-21 10:28:53] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102853&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102853157&vnp_Version=2.1.0&vnp_SecureHash=e47b263dd635232dfdd9f6c2988760955ce360f7737e1c68fc95990325fc7e501b298b876f78a95f9dd2dfba33dfc5a3d0c5f0a6179917da2ef4412506d110c3

[2025-05-21 10:28:53] Updated payment record with reference_id:
{
  "paymentId": 204,
  "orderId": "102853157",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 10:28:53] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521102853&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=102853157&vnp_Version=2.1.0&vnp_SecureHash=e47b263dd635232dfdd9f6c2988760955ce360f7737e1c68fc95990325fc7e501b298b876f78a95f9dd2dfba33dfc5a3d0c5f0a6179917da2ef4412506d110c3"
}

[2025-05-21 10:34:05] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:36:24] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 10:59:38] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:00:13] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:00:34] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "158",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:00:34] Booking check result:
{
  "found": true,
  "bookingId": "158"
}

[2025-05-21 11:00:34] Created payment record:
{
  "paymentId": 206,
  "bookingId": "158",
  "amount": 4800000
}

[2025-05-21 11:00:34] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "110034158",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_CreateDate": "20250521110034",
  "vnp_BankCode": ""
}

[2025-05-21 11:00:34] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521110034",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.101",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "110034158",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:00:34] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110034&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110034158&vnp_Version=2.1.0

[2025-05-21 11:00:34] VNPay generated signature:
2b466477f3d05ba74028244e4d0b359f0226e5d1e9a60ee905bca4a3ad8ed51c71f3ca7c0c51dfba76fa374832c59b5d74fc8bda39c0914a2153684c384c92c3

[2025-05-21 11:00:34] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110034&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110034158&vnp_Version=2.1.0&vnp_SecureHash=2b466477f3d05ba74028244e4d0b359f0226e5d1e9a60ee905bca4a3ad8ed51c71f3ca7c0c51dfba76fa374832c59b5d74fc8bda39c0914a2153684c384c92c3

[2025-05-21 11:00:34] Updated payment record with reference_id:
{
  "paymentId": 206,
  "orderId": "110034158",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:00:34] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110034&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.101&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110034158&vnp_Version=2.1.0&vnp_SecureHash=2b466477f3d05ba74028244e4d0b359f0226e5d1e9a60ee905bca4a3ad8ed51c71f3ca7c0c51dfba76fa374832c59b5d74fc8bda39c0914a2153684c384c92c3"
}

[2025-05-21 11:02:42] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:02:53] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:02:54] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:03:43] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:04:45] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:04:45] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:05:18] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:05:19] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:05:19] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:05:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:06:20] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:06:31] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "158",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:06:31] Booking check result:
{
  "found": true,
  "bookingId": "158"
}

[2025-05-21 11:06:31] Created payment record:
{
  "paymentId": 207,
  "bookingId": "158",
  "amount": 4800000
}

[2025-05-21 11:06:31] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:06:31] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "110631158",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "::ffff:192.168.0.100",
  "vnp_CreateDate": "20250521110631",
  "vnp_BankCode": ""
}

[2025-05-21 11:06:31] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_BankCode": "",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521110631",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "::ffff:192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "110631158",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:06:31] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110631&vnp_CurrCode=VND&vnp_IpAddr=::ffff:192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110631158&vnp_Version=2.1.0

[2025-05-21 11:06:31] VNPay generated signature:
2a63350a9c2be3d584d106327c828b7bd71605507593882d3da6192fbdf11d058220ef454a4a496331725f74a4ac01efa3282032bb5692c7ef868ea59a1112d1

[2025-05-21 11:06:31] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110631&vnp_CurrCode=VND&vnp_IpAddr=::ffff:192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110631158&vnp_Version=2.1.0&vnp_SecureHash=2a63350a9c2be3d584d106327c828b7bd71605507593882d3da6192fbdf11d058220ef454a4a496331725f74a4ac01efa3282032bb5692c7ef868ea59a1112d1

[2025-05-21 11:06:31] Updated payment record with reference_id:
{
  "paymentId": 207,
  "orderId": "110631158",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:06:31] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=&vnp_Command=pay&vnp_CreateDate=20250521110631&vnp_CurrCode=VND&vnp_IpAddr=::ffff:192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110631158&vnp_Version=2.1.0&vnp_SecureHash=2a63350a9c2be3d584d106327c828b7bd71605507593882d3da6192fbdf11d058220ef454a4a496331725f74a4ac01efa3282032bb5692c7ef868ea59a1112d1"
}

[2025-05-21 11:07:45] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:07:48] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:08:11] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "158",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:08:11] Booking check result:
{
  "found": true,
  "bookingId": "158"
}

[2025-05-21 11:08:11] Created payment record:
{
  "paymentId": 208,
  "bookingId": "158",
  "amount": 4800000
}

[2025-05-21 11:08:11] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:08:11] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "110811158",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521110811",
  "vnp_BankCode": ""
}

[2025-05-21 11:08:11] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521110811",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "110811158",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:08:11] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521110811&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110811158&vnp_Version=2.1.0

[2025-05-21 11:08:11] VNPay generated signature:
d3efe3ea254c1e8936f01eedf5b4b1193680083419368d409c807cb93515b4af002091751a991bfb410b4e08988a177db84b2d232b91af9abb3ae79589bb4ca4

[2025-05-21 11:08:11] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521110811&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110811158&vnp_Version=2.1.0&vnp_SecureHash=d3efe3ea254c1e8936f01eedf5b4b1193680083419368d409c807cb93515b4af002091751a991bfb410b4e08988a177db84b2d232b91af9abb3ae79589bb4ca4

[2025-05-21 11:08:11] Updated payment record with reference_id:
{
  "paymentId": 208,
  "orderId": "110811158",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:08:11] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521110811&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=110811158&vnp_Version=2.1.0&vnp_SecureHash=d3efe3ea254c1e8936f01eedf5b4b1193680083419368d409c807cb93515b4af002091751a991bfb410b4e08988a177db84b2d232b91af9abb3ae79589bb4ca4"
}

[2025-05-21 11:08:18] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:08:20] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:15:11] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "159",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:15:11] Booking check result:
{
  "found": true,
  "bookingId": "159"
}

[2025-05-21 11:15:11] Created payment record:
{
  "paymentId": 210,
  "bookingId": "159",
  "amount": 180000
}

[2025-05-21 11:15:11] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:15:11] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "111511159",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521111511",
  "vnp_BankCode": ""
}

[2025-05-21 11:15:11] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521111511",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "111511159",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:15:11] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111511&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111511159&vnp_Version=2.1.0

[2025-05-21 11:15:11] VNPay generated signature:
0dc821118a79d43fa3b41ed9c6ac4fc5683d9d19c6556e5f70d502a8c792821f22d06bb044f4094deb55c2508562750e3b93c11a51ab6367748249f27294a52e

[2025-05-21 11:15:11] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111511&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111511159&vnp_Version=2.1.0&vnp_SecureHash=0dc821118a79d43fa3b41ed9c6ac4fc5683d9d19c6556e5f70d502a8c792821f22d06bb044f4094deb55c2508562750e3b93c11a51ab6367748249f27294a52e

[2025-05-21 11:15:11] Updated payment record with reference_id:
{
  "paymentId": 210,
  "orderId": "111511159",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:15:11] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111511&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111511159&vnp_Version=2.1.0&vnp_SecureHash=0dc821118a79d43fa3b41ed9c6ac4fc5683d9d19c6556e5f70d502a8c792821f22d06bb044f4094deb55c2508562750e3b93c11a51ab6367748249f27294a52e"
}

[2025-05-21 11:18:46] === VNPAY RETURN CALLBACK RECEIVED ===
{
  "query": {
    "vnp_Amount": "18000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14970022",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521111722",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14970022",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "111511159",
    "vnp_SecureHash": "32c22cbeeae7369daae4ae0f77df9edc4e172e9cf19895683d44aa092dde005c7898094b67198c62d298f0e551007dbb781e4bfb8db0108be1b106430d089bda"
  },
  "headers": {
    "host": "0422-113-22-46-72.ngrok-free.app",
    "user-agent": "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Mobile Safari/537.36",
    "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
    "accept-encoding": "gzip, deflate, br, zstd",
    "accept-language": "en-AU,en;q=0.9,vi-VN;q=0.8,vi;q=0.7,en-GB;q=0.6,en-US;q=0.5",
    "cache-control": "max-age=0",
    "cookie": "abuse_interstitial=0422-113-22-46-72.ngrok-free.app",
    "dnt": "1",
    "priority": "u=0, i",
    "sec-ch-ua": "\"Chromium\";v=\"136\", \"Google Chrome\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
    "sec-ch-ua-mobile": "?1",
    "sec-ch-ua-platform": "\"Android\"",
    "sec-fetch-dest": "document",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1",
    "x-forwarded-for": "113.22.46.72",
    "x-forwarded-host": "0422-113-22-46-72.ngrok-free.app",
    "x-forwarded-proto": "https"
  },
  "ip": "::1"
}

[2025-05-21 11:18:46] Original hash from VNPay:
32c22cbeeae7369daae4ae0f77df9edc4e172e9cf19895683d44aa092dde005c7898094b67198c62d298f0e551007dbb781e4bfb8db0108be1b106430d089bda

[2025-05-21 11:18:46] Cleaned hash from VNPay:
32c22cbeeae7369daae4ae0f77df9edc4e172e9cf19895683d44aa092dde005c7898094b67198c62d298f0e551007dbb781e4bfb8db0108be1b106430d089bda

[2025-05-21 11:18:46] Hash type:
SHA512

[2025-05-21 11:18:46] Return raw params (before sorting):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970022",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521111722",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970022",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "111511159"
}

[2025-05-21 11:18:46] Return sorted params (method 1):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970022",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_PayDate": "20250521111722",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970022",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "111511159"
}

[2025-05-21 11:18:46] Return sorted params (method 2):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970022",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521111722",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970022",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "111511159"
}

[2025-05-21 11:18:46] Return Verification signData (method 1):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970022&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521111722&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970022&vnp_TransactionStatus=00&vnp_TxnRef=111511159

[2025-05-21 11:18:46] Return Verification signData (method 2):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970022&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521111722&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970022&vnp_TransactionStatus=00&vnp_TxnRef=111511159

[2025-05-21 11:18:46] Return Expected hash (method 1):
32c22cbeeae7369daae4ae0f77df9edc4e172e9cf19895683d44aa092dde005c7898094b67198c62d298f0e551007dbb781e4bfb8db0108be1b106430d089bda

[2025-05-21 11:18:46] Return Expected hash (method 2):
7fd24ae87bfe5ae66c87f3fd1d3a8d0812b99cf623bc0c82818d0e5fce073650fc6c3b7078e55315e8a4bc7c8ded454da3fe8d72c5e0678bb82e029f642e0ceb

[2025-05-21 11:18:46] Return Received hash:
32c22cbeeae7369daae4ae0f77df9edc4e172e9cf19895683d44aa092dde005c7898094b67198c62d298f0e551007dbb781e4bfb8db0108be1b106430d089bda

[2025-05-21 11:18:46] Return Verification signData (method 3):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970022&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521111722&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970022&vnp_TransactionStatus=00&vnp_TxnRef=111511159

[2025-05-21 11:18:46] Return Expected hash (method 3):
7fd24ae87bfe5ae66c87f3fd1d3a8d0812b99cf623bc0c82818d0e5fce073650fc6c3b7078e55315e8a4bc7c8ded454da3fe8d72c5e0678bb82e029f642e0ceb

[2025-05-21 11:18:46] Prepared response data:
{
  "vnp_ResponseCode": "00",
  "orderId": "111511159",
  "amount": 180000,
  "message": ""
}

[2025-05-21 11:18:46] === VNPAY RETURN CALLBACK - SUCCESS ===

[2025-05-21 11:18:46] Redirecting to app:
parkingapp://payment-result?vnp_ResponseCode=00&orderId=111511159&amount=180000&message=Payment%20successful

[2025-05-21 11:19:25] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "159",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:19:25] Booking check result:
{
  "found": true,
  "bookingId": "159"
}

[2025-05-21 11:19:25] Created payment record:
{
  "paymentId": 211,
  "bookingId": "159",
  "amount": 180000
}

[2025-05-21 11:19:25] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:19:25] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "111925159",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521111925",
  "vnp_BankCode": ""
}

[2025-05-21 11:19:25] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521111925",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "111925159",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:19:25] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111925&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111925159&vnp_Version=2.1.0

[2025-05-21 11:19:25] VNPay generated signature:
60441be8e098bd0187193accaa26d3e2e3641d45ce96092b87c5cbbc1f564b881625eba5f7ae329935739c5da8e62923e6391932938d13444ec258444a461163

[2025-05-21 11:19:25] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111925&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111925159&vnp_Version=2.1.0&vnp_SecureHash=60441be8e098bd0187193accaa26d3e2e3641d45ce96092b87c5cbbc1f564b881625eba5f7ae329935739c5da8e62923e6391932938d13444ec258444a461163

[2025-05-21 11:19:25] Updated payment record with reference_id:
{
  "paymentId": 211,
  "orderId": "111925159",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:19:25] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521111925&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=111925159&vnp_Version=2.1.0&vnp_SecureHash=60441be8e098bd0187193accaa26d3e2e3641d45ce96092b87c5cbbc1f564b881625eba5f7ae329935739c5da8e62923e6391932938d13444ec258444a461163"
}

[2025-05-21 11:21:49] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "159",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:21:49] Booking check result:
{
  "found": true,
  "bookingId": "159"
}

[2025-05-21 11:21:49] Created payment record:
{
  "paymentId": 212,
  "bookingId": "159",
  "amount": 180000
}

[2025-05-21 11:21:49] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:21:49] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "112149159",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521112149",
  "vnp_BankCode": ""
}

[2025-05-21 11:21:49] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521112149",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "112149159",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:21:49] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112149&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112149159&vnp_Version=2.1.0

[2025-05-21 11:21:49] VNPay generated signature:
da60f661b44ee1831d49c366d68d9dd08037575601ab868f0d572c56a223bd4408bb90e0b2a32cec66f64e35594e8068737e86a8a91d2855942e005a84e83307

[2025-05-21 11:21:49] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112149&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112149159&vnp_Version=2.1.0&vnp_SecureHash=da60f661b44ee1831d49c366d68d9dd08037575601ab868f0d572c56a223bd4408bb90e0b2a32cec66f64e35594e8068737e86a8a91d2855942e005a84e83307

[2025-05-21 11:21:49] Updated payment record with reference_id:
{
  "paymentId": 212,
  "orderId": "112149159",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:21:49] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112149&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112149159&vnp_Version=2.1.0&vnp_SecureHash=da60f661b44ee1831d49c366d68d9dd08037575601ab868f0d572c56a223bd4408bb90e0b2a32cec66f64e35594e8068737e86a8a91d2855942e005a84e83307"
}

[2025-05-21 11:29:37] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "160",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K15 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:29:37] Booking check result:
{
  "found": true,
  "bookingId": "160"
}

[2025-05-21 11:29:37] Created payment record:
{
  "paymentId": 214,
  "bookingId": "160",
  "amount": 180000
}

[2025-05-21 11:29:37] VNPay ReturnUrl being used:
https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 11:29:37] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "112937160",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K15 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521112937",
  "vnp_BankCode": ""
}

[2025-05-21 11:29:37] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521112937",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "112937160",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:29:37] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112937&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112937160&vnp_Version=2.1.0

[2025-05-21 11:29:37] VNPay generated signature:
5b996e76e303b6dce66a8961fa7f166d61da383c7a78c18536357808bdb3c302b4c94fc6568d2bf1c15be702414f1dd89ee240f3a5bfa42f302fed5255b16f1e

[2025-05-21 11:29:37] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112937&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112937160&vnp_Version=2.1.0&vnp_SecureHash=5b996e76e303b6dce66a8961fa7f166d61da383c7a78c18536357808bdb3c302b4c94fc6568d2bf1c15be702414f1dd89ee240f3a5bfa42f302fed5255b16f1e

[2025-05-21 11:29:37] Updated payment record with reference_id:
{
  "paymentId": 214,
  "orderId": "112937160",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:29:37] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521112937&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K15+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2F0422-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=112937160&vnp_Version=2.1.0&vnp_SecureHash=5b996e76e303b6dce66a8961fa7f166d61da383c7a78c18536357808bdb3c302b4c94fc6568d2bf1c15be702414f1dd89ee240f3a5bfa42f302fed5255b16f1e"
}

[2025-05-21 11:39:25] === VNPAY RETURN CALLBACK RECEIVED ===
{
  "query": {
    "vnp_Amount": "18000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14970059",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521112325",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14970059",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "112149159",
    "vnp_SecureHash": "0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88"
  },
  "headers": {
    "host": "0422-113-22-46-72.ngrok-free.app",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0",
    "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
    "accept-encoding": "gzip, deflate, br, zstd",
    "accept-language": "en-US,en;q=0.9",
    "cache-control": "max-age=0",
    "cookie": "abuse_interstitial=0422-113-22-46-72.ngrok-free.app",
    "priority": "u=0, i",
    "sec-ch-ua": "\"Chromium\";v=\"136\", \"Microsoft Edge\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"Windows\"",
    "sec-fetch-dest": "document",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1",
    "x-forwarded-for": "113.22.46.72",
    "x-forwarded-host": "0422-113-22-46-72.ngrok-free.app",
    "x-forwarded-proto": "https"
  },
  "ip": "::1"
}

[2025-05-21 11:39:25] Original hash from VNPay:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Cleaned hash from VNPay:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Hash type:
SHA512

[2025-05-21 11:39:25] Return raw params (before sorting):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return sorted params (method 1):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return sorted params (method 2):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return Verification signData (method 1):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Verification signData (method 2):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Expected hash (method 1):
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Return Expected hash (method 2):
6742cce871fbd0d6345977995e5761fa56578263d2c5acb55482e2376268faf9cc40cab23701b79b4a1e1f46b732df12ef1d88b637dc9a75a9b87ae0dee63b19

[2025-05-21 11:39:25] Return Received hash:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Return Verification signData (method 3):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Expected hash (method 3):
6742cce871fbd0d6345977995e5761fa56578263d2c5acb55482e2376268faf9cc40cab23701b79b4a1e1f46b732df12ef1d88b637dc9a75a9b87ae0dee63b19

[2025-05-21 11:39:25] Prepared response data:
{
  "vnp_ResponseCode": "00",
  "orderId": "112149159",
  "amount": 180000,
  "message": ""
}

[2025-05-21 11:39:25] === VNPAY RETURN CALLBACK - SUCCESS ===

[2025-05-21 11:39:25] Redirecting to app:
parkingapp://payment-result?vnp_ResponseCode=00&orderId=112149159&amount=180000&message=Payment%20successful

[2025-05-21 11:39:25] === VNPAY RETURN CALLBACK RECEIVED ===
{
  "query": {
    "vnp_Amount": "18000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14970059",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521112325",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14970059",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "112149159",
    "vnp_SecureHash": "0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88"
  },
  "headers": {
    "host": "0422-113-22-46-72.ngrok-free.app",
    "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0",
    "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
    "accept-encoding": "gzip, deflate, br, zstd",
    "accept-language": "en-US,en;q=0.9",
    "cache-control": "max-age=0",
    "cookie": "abuse_interstitial=0422-113-22-46-72.ngrok-free.app",
    "priority": "u=0, i",
    "sec-ch-ua": "\"Chromium\";v=\"136\", \"Microsoft Edge\";v=\"136\", \"Not.A/Brand\";v=\"99\"",
    "sec-ch-ua-mobile": "?0",
    "sec-ch-ua-platform": "\"Windows\"",
    "sec-fetch-dest": "document",
    "sec-fetch-mode": "navigate",
    "sec-fetch-site": "same-origin",
    "sec-fetch-user": "?1",
    "upgrade-insecure-requests": "1",
    "x-forwarded-for": "113.22.46.72",
    "x-forwarded-host": "0422-113-22-46-72.ngrok-free.app",
    "x-forwarded-proto": "https"
  },
  "ip": "::1"
}

[2025-05-21 11:39:25] Original hash from VNPay:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Cleaned hash from VNPay:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Hash type:
SHA512

[2025-05-21 11:39:25] Return raw params (before sorting):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return sorted params (method 1):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return sorted params (method 2):
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14970059",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521112325",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14970059",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "112149159"
}

[2025-05-21 11:39:25] Return Verification signData (method 1):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Verification signData (method 2):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Expected hash (method 1):
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Return Expected hash (method 2):
6742cce871fbd0d6345977995e5761fa56578263d2c5acb55482e2376268faf9cc40cab23701b79b4a1e1f46b732df12ef1d88b637dc9a75a9b87ae0dee63b19

[2025-05-21 11:39:25] Return Received hash:
0dce8d569ab2a70e705b72b472e193663359d2716e65205f79a993c7198476f722f03aa67a70adeb16b786b06e931e95a617eff08e0df3d549f8d1d38e912d88

[2025-05-21 11:39:25] Return Verification signData (method 3):
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14970059&vnp_CardType=ATM&vnp_OrderInfo=Thanh toán đặt chỗ K11 - 2025-05-21&vnp_PayDate=20250521112325&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14970059&vnp_TransactionStatus=00&vnp_TxnRef=112149159

[2025-05-21 11:39:25] Return Expected hash (method 3):
6742cce871fbd0d6345977995e5761fa56578263d2c5acb55482e2376268faf9cc40cab23701b79b4a1e1f46b732df12ef1d88b637dc9a75a9b87ae0dee63b19

[2025-05-21 11:39:25] Prepared response data:
{
  "vnp_ResponseCode": "00",
  "orderId": "112149159",
  "amount": 180000,
  "message": ""
}

[2025-05-21 11:39:25] === VNPAY RETURN CALLBACK - SUCCESS ===

[2025-05-21 11:39:25] Redirecting to app:
parkingapp://payment-result?vnp_ResponseCode=00&orderId=112149159&amount=180000&message=Payment%20successful

[2025-05-21 11:39:41] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://0422-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 11:39:42] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:40:52] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:40:53] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:42:19] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:42:38] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:42:53] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:43:16] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "161",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:43:16] Booking check result:
{
  "found": true,
  "bookingId": "161"
}

[2025-05-21 11:43:16] Created payment record:
{
  "paymentId": 216,
  "bookingId": "161",
  "amount": 180000
}

[2025-05-21 11:43:16] VNPay ReturnUrl being used:
https://stupid-jars-sit.loca.lt/api/payment/vnpay-return

[2025-05-21 11:43:16] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "114316161",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521114316",
  "vnp_BankCode": ""
}

[2025-05-21 11:43:16] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521114316",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "114316161",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:43:16] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521114316&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=114316161&vnp_Version=2.1.0

[2025-05-21 11:43:16] VNPay generated signature:
39481396ef812da906c29895c25177a2d10c85587061f656e481f6e178f26ea74970cde742592040d6d5cd2e3f9ae520102ed4c5d145c88c1e40033b698874a4

[2025-05-21 11:43:16] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521114316&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=114316161&vnp_Version=2.1.0&vnp_SecureHash=39481396ef812da906c29895c25177a2d10c85587061f656e481f6e178f26ea74970cde742592040d6d5cd2e3f9ae520102ed4c5d145c88c1e40033b698874a4

[2025-05-21 11:43:16] Updated payment record with reference_id:
{
  "paymentId": 216,
  "orderId": "114316161",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:43:16] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521114316&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=114316161&vnp_Version=2.1.0&vnp_SecureHash=39481396ef812da906c29895c25177a2d10c85587061f656e481f6e178f26ea74970cde742592040d6d5cd2e3f9ae520102ed4c5d145c88c1e40033b698874a4"
}

[2025-05-21 11:53:20] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 11:54:02] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "161",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:54:02] Booking check result:
{
  "found": true,
  "bookingId": "161"
}

[2025-05-21 11:54:02] Created payment record:
{
  "paymentId": 217,
  "bookingId": "161",
  "amount": 180000
}

[2025-05-21 11:54:02] VNPay ReturnUrl being used:
https://stupid-jars-sit.loca.lt/api/payment/vnpay-return

[2025-05-21 11:54:02] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "115402161",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521115402",
  "vnp_BankCode": ""
}

[2025-05-21 11:54:02] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521115402",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "115402161",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:54:02] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115402&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115402161&vnp_Version=2.1.0

[2025-05-21 11:54:02] VNPay generated signature:
018b42d00dd06be65de722849b8d4ff464d2855655ffdc5fc4f28d0b635e18ec308678ac466384d28c1a59d16da1d3c5db4e53039857417ee0f0bfabf348c8e4

[2025-05-21 11:54:02] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115402&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115402161&vnp_Version=2.1.0&vnp_SecureHash=018b42d00dd06be65de722849b8d4ff464d2855655ffdc5fc4f28d0b635e18ec308678ac466384d28c1a59d16da1d3c5db4e53039857417ee0f0bfabf348c8e4

[2025-05-21 11:54:02] Updated payment record with reference_id:
{
  "paymentId": 217,
  "orderId": "115402161",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:54:02] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115402&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115402161&vnp_Version=2.1.0&vnp_SecureHash=018b42d00dd06be65de722849b8d4ff464d2855655ffdc5fc4f28d0b635e18ec308678ac466384d28c1a59d16da1d3c5db4e53039857417ee0f0bfabf348c8e4"
}

[2025-05-21 11:55:15] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "162",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K02 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:55:16] Booking check result:
{
  "found": true,
  "bookingId": "162"
}

[2025-05-21 11:55:16] Created payment record:
{
  "paymentId": 219,
  "bookingId": "162",
  "amount": 180000
}

[2025-05-21 11:55:16] VNPay ReturnUrl being used:
https://stupid-jars-sit.loca.lt/api/payment/vnpay-return

[2025-05-21 11:55:16] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "115516162",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K02 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521115516",
  "vnp_BankCode": ""
}

[2025-05-21 11:55:16] VNPay sorted params:
{
  "vnp_Amount": 18000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521115516",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K02+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "115516162",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:55:16] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115516&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K02+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115516162&vnp_Version=2.1.0

[2025-05-21 11:55:16] VNPay generated signature:
b97914ccb7350dc31c5784cbcc50761a52185b736384fc8cd8fa6bc8f2b6dcc2e0fd92e62de597d6301c6a2ac968e47d3b25cb70db122f891cb6f5f52f460ff9

[2025-05-21 11:55:16] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115516&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K02+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115516162&vnp_Version=2.1.0&vnp_SecureHash=b97914ccb7350dc31c5784cbcc50761a52185b736384fc8cd8fa6bc8f2b6dcc2e0fd92e62de597d6301c6a2ac968e47d3b25cb70db122f891cb6f5f52f460ff9

[2025-05-21 11:55:16] Updated payment record with reference_id:
{
  "paymentId": 219,
  "orderId": "115516162",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:55:16] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521115516&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K02+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115516162&vnp_Version=2.1.0&vnp_SecureHash=b97914ccb7350dc31c5784cbcc50761a52185b736384fc8cd8fa6bc8f2b6dcc2e0fd92e62de597d6301c6a2ac968e47d3b25cb70db122f891cb6f5f52f460ff9"
}

[2025-05-21 11:56:27] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "163",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:56:27] Booking check result:
{
  "found": true,
  "bookingId": "163"
}

[2025-05-21 11:56:27] Created payment record:
{
  "paymentId": 221,
  "bookingId": "163",
  "amount": 4800000
}

[2025-05-21 11:56:27] VNPay ReturnUrl being used:
https://stupid-jars-sit.loca.lt/api/payment/vnpay-return

[2025-05-21 11:56:27] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "115627163",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521115627",
  "vnp_BankCode": ""
}

[2025-05-21 11:56:27] VNPay sorted params:
{
  "vnp_Amount": 480000000,
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521115627",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "115627163",
  "vnp_Version": "2.1.0"
}

[2025-05-21 11:56:27] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521115627&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115627163&vnp_Version=2.1.0

[2025-05-21 11:56:27] VNPay generated signature:
1a4ed52fe8fb9dab4160d6f904e1c2f241f867ee007035663382e8d7e74f2f7c65d24c7b96b89f5cf9eed4f198720f03b5c0f65e0f31d656fa09f678d63135f7

[2025-05-21 11:56:27] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521115627&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115627163&vnp_Version=2.1.0&vnp_SecureHash=1a4ed52fe8fb9dab4160d6f904e1c2f241f867ee007035663382e8d7e74f2f7c65d24c7b96b89f5cf9eed4f198720f03b5c0f65e0f31d656fa09f678d63135f7

[2025-05-21 11:56:27] Updated payment record with reference_id:
{
  "paymentId": 221,
  "orderId": "115627163",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 11:56:27] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521115627&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Fstupid-jars-sit.loca.lt%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=115627163&vnp_Version=2.1.0&vnp_SecureHash=1a4ed52fe8fb9dab4160d6f904e1c2f241f867ee007035663382e8d7e74f2f7c65d24c7b96b89f5cf9eed4f198720f03b5c0f65e0f31d656fa09f678d63135f7"
}

[2025-05-21 21:24:45] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://stupid-jars-sit.loca.lt/api/payment/vnpay-ipn"
}

[2025-05-21 21:26:42] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:28:09] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:28:18] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:29:22] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:29:27] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:30:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:30:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:50:22] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 21:59:46] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:02:12] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:03:35] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "164",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:03:35] Booking check result:
{
  "found": true,
  "bookingId": "164"
}

[2025-05-21 22:03:35] Created payment record:
{
  "paymentId": 223,
  "bookingId": "164",
  "amount": 180000
}

[2025-05-21 22:03:35] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:03:35] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "220335164",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521220335",
  "vnp_BankCode": ""
}

[2025-05-21 22:03:35] VNPay sorted params:
{
  "vnp_Amount": "18000000",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521220335",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "220335164",
  "vnp_Version": "2.1.0"
}

[2025-05-21 22:03:35] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220335&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220335164&vnp_Version=2.1.0

[2025-05-21 22:03:35] VNPay generated signature:
0aff86cf81af70b471193d6a22c516fca535fb89091f7f75c7a74f3f978e5a9c4f4ffb4049d9bf5b40b17da99d10acad747ef54cbc771766cd377f32401f86cf

[2025-05-21 22:03:35] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220335&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220335164&vnp_Version=2.1.0&vnp_SecureHash=0aff86cf81af70b471193d6a22c516fca535fb89091f7f75c7a74f3f978e5a9c4f4ffb4049d9bf5b40b17da99d10acad747ef54cbc771766cd377f32401f86cf

[2025-05-21 22:03:35] Updated payment record with reference_id:
{
  "paymentId": 223,
  "orderId": "220335164",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:03:35] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220335&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220335164&vnp_Version=2.1.0&vnp_SecureHash=0aff86cf81af70b471193d6a22c516fca535fb89091f7f75c7a74f3f978e5a9c4f4ffb4049d9bf5b40b17da99d10acad747ef54cbc771766cd377f32401f86cf"
}

[2025-05-21 22:09:59] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "164",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:09:59] Booking check result:
{
  "found": true,
  "bookingId": "164"
}

[2025-05-21 22:09:59] Created payment record:
{
  "paymentId": 224,
  "bookingId": "164",
  "amount": 180000
}

[2025-05-21 22:09:59] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:09:59] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "220959164",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521220959",
  "vnp_BankCode": ""
}

[2025-05-21 22:09:59] VNPay sorted params:
{
  "vnp_Amount": "18000000",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521220959",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "220959164",
  "vnp_Version": "2.1.0"
}

[2025-05-21 22:09:59] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220959&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220959164&vnp_Version=2.1.0

[2025-05-21 22:09:59] VNPay generated signature:
847ca907b4e7cf0d5a4f2879e52881605011f718c243a655e3eee27c8049d4196b7d66f40f8be4d65a6854bfa96a60255a3a1c079d3b25c091a8bfee87e9325a

[2025-05-21 22:09:59] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220959&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220959164&vnp_Version=2.1.0&vnp_SecureHash=847ca907b4e7cf0d5a4f2879e52881605011f718c243a655e3eee27c8049d4196b7d66f40f8be4d65a6854bfa96a60255a3a1c079d3b25c091a8bfee87e9325a

[2025-05-21 22:09:59] Updated payment record with reference_id:
{
  "paymentId": 224,
  "orderId": "220959164",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:09:59] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521220959&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=220959164&vnp_Version=2.1.0&vnp_SecureHash=847ca907b4e7cf0d5a4f2879e52881605011f718c243a655e3eee27c8049d4196b7d66f40f8be4d65a6854bfa96a60255a3a1c079d3b25c091a8bfee87e9325a"
}

[2025-05-21 22:11:48] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "164",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:11:48] Booking check result:
{
  "found": true,
  "bookingId": "164"
}

[2025-05-21 22:11:48] Created payment record:
{
  "paymentId": 225,
  "bookingId": "164",
  "amount": 180000
}

[2025-05-21 22:11:48] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:11:48] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "221148164",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521221148",
  "vnp_BankCode": ""
}

[2025-05-21 22:11:48] VNPay sorted params:
{
  "vnp_Amount": "18000000",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521221148",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "221148164",
  "vnp_Version": "2.1.0"
}

[2025-05-21 22:11:48] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221148&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221148164&vnp_Version=2.1.0

[2025-05-21 22:11:48] VNPay generated signature:
4d58d0b7d843fd3ea1f4ed08d90600d0cc0788a9761a7c52f57df7b75e44d9c5a2faccb94f7b5ce1d729420c62292cb8db8ec7109e6af9a6f46b84b3ad6a306b

[2025-05-21 22:11:48] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221148&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221148164&vnp_Version=2.1.0&vnp_SecureHash=4d58d0b7d843fd3ea1f4ed08d90600d0cc0788a9761a7c52f57df7b75e44d9c5a2faccb94f7b5ce1d729420c62292cb8db8ec7109e6af9a6f46b84b3ad6a306b

[2025-05-21 22:11:48] Updated payment record with reference_id:
{
  "paymentId": 225,
  "orderId": "221148164",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:11:48] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221148&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221148164&vnp_Version=2.1.0&vnp_SecureHash=4d58d0b7d843fd3ea1f4ed08d90600d0cc0788a9761a7c52f57df7b75e44d9c5a2faccb94f7b5ce1d729420c62292cb8db8ec7109e6af9a6f46b84b3ad6a306b"
}

[2025-05-21 22:11:57] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "164",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:11:57] Booking check result:
{
  "found": true,
  "bookingId": "164"
}

[2025-05-21 22:11:57] Created payment record:
{
  "paymentId": 226,
  "bookingId": "164",
  "amount": 180000
}

[2025-05-21 22:11:57] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:11:57] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "221157164",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K06 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 18000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521221157",
  "vnp_BankCode": ""
}

[2025-05-21 22:11:57] VNPay sorted params:
{
  "vnp_Amount": "18000000",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521221157",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "221157164",
  "vnp_Version": "2.1.0"
}

[2025-05-21 22:11:57] VNPay signData string:
vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221157&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221157164&vnp_Version=2.1.0

[2025-05-21 22:11:57] VNPay generated signature:
cbce0d392dcffb7ff38a782a1d6da8b6582def94df781753b9e87572c54a46e25015f638823a14d608da78e27cfd27c697afd6b864fb985a3567b17d0dec9f60

[2025-05-21 22:11:57] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221157&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221157164&vnp_Version=2.1.0&vnp_SecureHash=cbce0d392dcffb7ff38a782a1d6da8b6582def94df781753b9e87572c54a46e25015f638823a14d608da78e27cfd27c697afd6b864fb985a3567b17d0dec9f60

[2025-05-21 22:11:57] Updated payment record with reference_id:
{
  "paymentId": 226,
  "orderId": "221157164",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:11:57] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_Command=pay&vnp_CreateDate=20250521221157&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K06+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221157164&vnp_Version=2.1.0&vnp_SecureHash=cbce0d392dcffb7ff38a782a1d6da8b6582def94df781753b9e87572c54a46e25015f638823a14d608da78e27cfd27c697afd6b864fb985a3567b17d0dec9f60"
}

[2025-05-21 22:12:41] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "165",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:12:41] Booking check result:
{
  "found": true,
  "bookingId": "165"
}

[2025-05-21 22:12:41] Created payment record:
{
  "paymentId": 228,
  "bookingId": "165",
  "amount": 4800000
}

[2025-05-21 22:12:41] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:12:41] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "221241165",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521221241",
  "vnp_BankCode": ""
}

[2025-05-21 22:12:41] VNPay sorted params:
{
  "vnp_Amount": "480000000",
  "vnp_Command": "pay",
  "vnp_CreateDate": "20250521221241",
  "vnp_CurrCode": "VND",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_Locale": "vn",
  "vnp_OrderInfo": "Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_ReturnUrl": "http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TxnRef": "221241165",
  "vnp_Version": "2.1.0"
}

[2025-05-21 22:12:41] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221241&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221241165&vnp_Version=2.1.0

[2025-05-21 22:12:41] VNPay generated signature:
2f3789c7aa3f1bcded8e2b065d0c9ba0efb69af89ecbbfc704b9c99ea810ca5912f8089e8d0bf4582b7619c9838806603e5e6c5e3982c2febf80a18c326f3ecc

[2025-05-21 22:12:41] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221241&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221241165&vnp_Version=2.1.0&vnp_SecureHash=2f3789c7aa3f1bcded8e2b065d0c9ba0efb69af89ecbbfc704b9c99ea810ca5912f8089e8d0bf4582b7619c9838806603e5e6c5e3982c2febf80a18c326f3ecc

[2025-05-21 22:12:41] Updated payment record with reference_id:
{
  "paymentId": 228,
  "orderId": "221241165",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:12:41] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221241&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221241165&vnp_Version=2.1.0&vnp_SecureHash=2f3789c7aa3f1bcded8e2b065d0c9ba0efb69af89ecbbfc704b9c99ea810ca5912f8089e8d0bf4582b7619c9838806603e5e6c5e3982c2febf80a18c326f3ecc"
}

[2025-05-21 22:15:32] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:15:58] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:16:01] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:16:43] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:16:45] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:16] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:18] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:38] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:43] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:43] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:44] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:46] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpnUrl": "http://192.168.0.101:3000/api/payment/vnpay-ipn"
}

[2025-05-21 22:17:52] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "165",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:17:52] Booking check result:
{
  "found": true,
  "bookingId": "165"
}

[2025-05-21 22:17:52] Created payment record:
{
  "paymentId": 229,
  "bookingId": "165",
  "amount": 4800000
}

[2025-05-21 22:17:52] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:17:52] VNPay ReturnUrl being used:
http://192.168.0.101:3000/api/payment/vnpay-return

[2025-05-21 22:17:52] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "221752165",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "http://192.168.0.101:3000/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521221752",
  "vnp_BankCode": ""
}

[2025-05-21 22:17:52] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221752&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221752165&vnp_Version=2.1.0

[2025-05-21 22:17:52] VNPay generated signature:
0c947a8dcf1ad3681585f46fb47caa8149e1bcc4bb0ae8223721a58e4c8ecb83d10ac903b2c6dc11c248dadd162d7bb73c8a893fb3a0e554477c53835ab38da0

[2025-05-21 22:17:52] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221752&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221752165&vnp_Version=2.1.0&vnp_SecureHash=0c947a8dcf1ad3681585f46fb47caa8149e1bcc4bb0ae8223721a58e4c8ecb83d10ac903b2c6dc11c248dadd162d7bb73c8a893fb3a0e554477c53835ab38da0

[2025-05-21 22:17:52] Updated payment record with reference_id:
{
  "paymentId": 229,
  "orderId": "221752165",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:17:52] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521221752&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=http%3A%2F%2F192.168.0.101%3A3000%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=221752165&vnp_Version=2.1.0&vnp_SecureHash=0c947a8dcf1ad3681585f46fb47caa8149e1bcc4bb0ae8223721a58e4c8ecb83d10ac903b2c6dc11c248dadd162d7bb73c8a893fb3a0e554477c53835ab38da0"
}

[2025-05-21 22:18:56] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:19:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:19:08] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:19:17] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:19:18] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:19:27] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:21:50] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:21:59] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:22:02] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "165",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:22:02] Booking check result:
{
  "found": true,
  "bookingId": "165"
}

[2025-05-21 22:22:02] Created payment record:
{
  "paymentId": 230,
  "bookingId": "165",
  "amount": 4800000
}

[2025-05-21 22:22:02] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:22:02] VNPay ReturnUrl being used:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:22:02] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "222202165",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521222202",
  "vnp_BankCode": ""
}

[2025-05-21 22:22:02] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222202&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222202165&vnp_Version=2.1.0

[2025-05-21 22:22:02] VNPay generated signature:
969be839397b6922398aec933a07e678d1c713b052ed002c3c1a866f762ac73d3b9bca45210b0bac1e4a4b9a5329ab4a949da6ca21f2f4de8a953e73ef6ccc98

[2025-05-21 22:22:02] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222202&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222202165&vnp_Version=2.1.0&vnp_SecureHash=969be839397b6922398aec933a07e678d1c713b052ed002c3c1a866f762ac73d3b9bca45210b0bac1e4a4b9a5329ab4a949da6ca21f2f4de8a953e73ef6ccc98

[2025-05-21 22:22:03] Updated payment record with reference_id:
{
  "paymentId": 230,
  "orderId": "222202165",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:22:03] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222202&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222202165&vnp_Version=2.1.0&vnp_SecureHash=969be839397b6922398aec933a07e678d1c713b052ed002c3c1a866f762ac73d3b9bca45210b0bac1e4a4b9a5329ab4a949da6ca21f2f4de8a953e73ef6ccc98"
}

[2025-05-21 22:23:04] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:23:04] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:23:04] Created payment record:
{
  "paymentId": 232,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:23:04] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:23:04] VNPay ReturnUrl being used:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:23:04] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "222304166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521222304",
  "vnp_BankCode": ""
}

[2025-05-21 22:23:04] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222304&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222304166&vnp_Version=2.1.0

[2025-05-21 22:23:04] VNPay generated signature:
00717ac2997badbee871253281da0186997609efe2ee809e2250db053bf005eb54d857e6ebe128ff959ea91c153faaf766da80b613e0ede3f035bd2828bc3511

[2025-05-21 22:23:04] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222304&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222304166&vnp_Version=2.1.0&vnp_SecureHash=00717ac2997badbee871253281da0186997609efe2ee809e2250db053bf005eb54d857e6ebe128ff959ea91c153faaf766da80b613e0ede3f035bd2828bc3511

[2025-05-21 22:23:04] Updated payment record with reference_id:
{
  "paymentId": 232,
  "orderId": "222304166",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:23:04] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222304&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222304166&vnp_Version=2.1.0&vnp_SecureHash=00717ac2997badbee871253281da0186997609efe2ee809e2250db053bf005eb54d857e6ebe128ff959ea91c153faaf766da80b613e0ede3f035bd2828bc3511"
}

[2025-05-21 22:23:46] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:23:56] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:16] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:29] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:31] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:41] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:44] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:53] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:24:55] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:21] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:23] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:34] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:37] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:48] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:25:50] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:26:00] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:26:02] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:26:13] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:26:13] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:26:13] Created payment record:
{
  "paymentId": 233,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:26:13] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:26:13] VNPay ReturnUrl being used:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:26:13] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "222613166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521222613"
}

[2025-05-21 22:26:13] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222613&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222613166&vnp_Version=2.1.0

[2025-05-21 22:26:13] VNPay generated signature:
d63b0efc0338b70d3d8d6be6b0da04abe89b278490fea56f8b03ad9588e77b24882abf1882743c247eaf5e0042872d75dd4436cf8456d24114509f0b92147abd

[2025-05-21 22:26:13] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222613&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222613166&vnp_Version=2.1.0&vnp_SecureHash=d63b0efc0338b70d3d8d6be6b0da04abe89b278490fea56f8b03ad9588e77b24882abf1882743c247eaf5e0042872d75dd4436cf8456d24114509f0b92147abd

[2025-05-21 22:26:13] Updated payment record with reference_id:
{
  "paymentId": 233,
  "orderId": "222613166",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:26:13] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222613&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222613166&vnp_Version=2.1.0&vnp_SecureHash=d63b0efc0338b70d3d8d6be6b0da04abe89b278490fea56f8b03ad9588e77b24882abf1882743c247eaf5e0042872d75dd4436cf8456d24114509f0b92147abd"
}

[2025-05-21 22:26:22] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:26:42] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:26:49] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:26:49] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:26:49] Created payment record:
{
  "paymentId": 234,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:26:49] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:26:49] VNPay ReturnUrl being used:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:26:49] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "222649166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521222649"
}

[2025-05-21 22:26:49] VNPay signData string:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222649&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222649166&vnp_Version=2.1.0

[2025-05-21 22:26:49] VNPay generated signature:
f50b29e882b52ede3a50a3a91bb31711e34cde5202034df2a066056c6d7916333e2113a8e68978b9db4f3956847733a750049c9811d88e0242401aa6499a3bac

[2025-05-21 22:26:49] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222649&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222649166&vnp_Version=2.1.0&vnp_SecureHash=f50b29e882b52ede3a50a3a91bb31711e34cde5202034df2a066056c6d7916333e2113a8e68978b9db4f3956847733a750049c9811d88e0242401aa6499a3bac

[2025-05-21 22:26:49] Updated payment record with reference_id:
{
  "paymentId": 234,
  "orderId": "222649166",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:26:49] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521222649&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=222649166&vnp_Version=2.1.0&vnp_SecureHash=f50b29e882b52ede3a50a3a91bb31711e34cde5202034df2a066056c6d7916333e2113a8e68978b9db4f3956847733a750049c9811d88e0242401aa6499a3bac"
}

[2025-05-21 22:27:07] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:28:35] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:28:50] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:29:13] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:29:15] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:29:55] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:13] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:19] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:30:19] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:30:19] Created payment record:
{
  "paymentId": 235,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:30:19] VNPay parameters:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "223019166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223019"
}

[2025-05-21 22:30:19] Query string for signature:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223019&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223019166&vnp_Version=2.1.0

[2025-05-21 22:30:19] Generated signature:
8b42f60d27c21d413b718f7d2f6ee82825b1a466971b2ac7d8273c95fba7ff57b58f81c0e5d86e839e02b9c5fb78d14c1d09f4f1d14d346b74794eea2b514089

[2025-05-21 22:30:19] Final payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223019&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223019166&vnp_Version=2.1.0&vnp_SecureHash=8b42f60d27c21d413b718f7d2f6ee82825b1a466971b2ac7d8273c95fba7ff57b58f81c0e5d86e839e02b9c5fb78d14c1d09f4f1d14d346b74794eea2b514089

[2025-05-21 22:30:19] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223019&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223019166&vnp_Version=2.1.0&vnp_SecureHash=8b42f60d27c21d413b718f7d2f6ee82825b1a466971b2ac7d8273c95fba7ff57b58f81c0e5d86e839e02b9c5fb78d14c1d09f4f1d14d346b74794eea2b514089"
}

[2025-05-21 22:30:23] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:26] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:37] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:39] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:30:54] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:31:20] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:31:28] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:31:59] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:32:04] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:32:04] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:32:04] Created payment record:
{
  "paymentId": 236,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:32:04] VNPay parameters:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "223204166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223204"
}

[2025-05-21 22:32:04] Query string for signature:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223204&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223204166&vnp_Version=2.1.0

[2025-05-21 22:32:04] Generated signature:
4f0be8ead0925ae20889d6b4692a5d3fdb577a9859857cc3f9c9180e4df19038b7d9dae1fa545d4548401cbb1f48f5592c7c3a0e5ee3e6f67c8fdf02f9c093f9

[2025-05-21 22:32:04] Final payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223204&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223204166&vnp_Version=2.1.0&vnp_SecureHash=4f0be8ead0925ae20889d6b4692a5d3fdb577a9859857cc3f9c9180e4df19038b7d9dae1fa545d4548401cbb1f48f5592c7c3a0e5ee3e6f67c8fdf02f9c093f9

[2025-05-21 22:32:04] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223204&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223204166&vnp_Version=2.1.0&vnp_SecureHash=4f0be8ead0925ae20889d6b4692a5d3fdb577a9859857cc3f9c9180e4df19038b7d9dae1fa545d4548401cbb1f48f5592c7c3a0e5ee3e6f67c8fdf02f9c093f9"
}

[2025-05-21 22:32:08] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:32:08] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:32:08] Created payment record:
{
  "paymentId": 237,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:32:08] VNPay parameters:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "223208166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223208"
}

[2025-05-21 22:32:08] Query string for signature:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223208&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223208166&vnp_Version=2.1.0

[2025-05-21 22:32:08] Generated signature:
763bc00ac6fcd5efda94a065e221401d6f06dd428c51c8860a4978a84532272c713054cf074cc0d28a6e0dce84bb1e2b608b3bae1a16e5423e2e74c4d896eec7

[2025-05-21 22:32:08] Final payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223208&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223208166&vnp_Version=2.1.0&vnp_SecureHash=763bc00ac6fcd5efda94a065e221401d6f06dd428c51c8860a4978a84532272c713054cf074cc0d28a6e0dce84bb1e2b608b3bae1a16e5423e2e74c4d896eec7

[2025-05-21 22:32:08] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223208&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223208166&vnp_Version=2.1.0&vnp_SecureHash=763bc00ac6fcd5efda94a065e221401d6f06dd428c51c8860a4978a84532272c713054cf074cc0d28a6e0dce84bb1e2b608b3bae1a16e5423e2e74c4d896eec7"
}

[2025-05-21 22:32:12] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:32:12] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:32:12] Created payment record:
{
  "paymentId": 238,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:32:12] VNPay parameters:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "223212166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223212"
}

[2025-05-21 22:32:12] Query string for signature:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223212&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223212166&vnp_Version=2.1.0

[2025-05-21 22:32:12] Generated signature:
27eb7b74cecaadfa7b80b24223d0be7642faecb4bf8867cc3a1e173e8cb481d3fd7158a014a2bd1440b15f364df4fcd4f2d230e65eca13aa2e40cdbfb2188530

[2025-05-21 22:32:12] Final payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223212&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223212166&vnp_Version=2.1.0&vnp_SecureHash=27eb7b74cecaadfa7b80b24223d0be7642faecb4bf8867cc3a1e173e8cb481d3fd7158a014a2bd1440b15f364df4fcd4f2d230e65eca13aa2e40cdbfb2188530

[2025-05-21 22:32:12] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223212&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223212166&vnp_Version=2.1.0&vnp_SecureHash=27eb7b74cecaadfa7b80b24223d0be7642faecb4bf8867cc3a1e173e8cb481d3fd7158a014a2bd1440b15f364df4fcd4f2d230e65eca13aa2e40cdbfb2188530"
}

[2025-05-21 22:32:17] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "166",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:32:17] Booking check result:
{
  "found": true,
  "bookingId": "166"
}

[2025-05-21 22:32:17] Created payment record:
{
  "paymentId": 239,
  "bookingId": "166",
  "amount": 4800000
}

[2025-05-21 22:32:17] VNPay parameters:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "223217166",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K12 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223217"
}

[2025-05-21 22:32:17] Query string for signature:
vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223217&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223217166&vnp_Version=2.1.0

[2025-05-21 22:32:17] Generated signature:
0b28e5ef893a39dafd653cdfef62242df7fbbf0d94fe2499318fdf2813a31e648e8f0bf95421b33c67850e54d7bb204b52fbb46f7037f54dcc47ccf8fd74cea5

[2025-05-21 22:32:17] Final payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223217&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223217166&vnp_Version=2.1.0&vnp_SecureHash=0b28e5ef893a39dafd653cdfef62242df7fbbf0d94fe2499318fdf2813a31e648e8f0bf95421b33c67850e54d7bb204b52fbb46f7037f54dcc47ccf8fd74cea5

[2025-05-21 22:32:17] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_Command=pay&vnp_CreateDate=20250521223217&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K12+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=223217166&vnp_Version=2.1.0&vnp_SecureHash=0b28e5ef893a39dafd653cdfef62242df7fbbf0d94fe2499318fdf2813a31e648e8f0bf95421b33c67850e54d7bb204b52fbb46f7037f54dcc47ccf8fd74cea5"
}

[2025-05-21 22:33:14] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:33:29] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:33:39] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:33:41] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:33:50] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:33:52] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:35:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:35:10] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:35:35] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:35:39] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:36:21] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:36:26] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:36:54] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:36:56] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:38:59] === CREATE VNPAY PAYMENT - REQUEST ===
{
  "bookingId": "167",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:38:59] Booking check result:
{
  "found": true,
  "bookingId": "167"
}

[2025-05-21 22:38:59] Created payment record:
{
  "paymentId": 241,
  "bookingId": "167",
  "amount": 4800000
}

[2025-05-21 22:38:59] Mobile app return URL detected:
parkingapp://payment-result

[2025-05-21 22:38:59] VNPay ReturnUrl being used:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:38:59] VNPay raw params:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "DH20250521223859167",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": 480000000,
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521223859",
  "vnp_BankCode": "NCB"
}

[2025-05-21 22:38:59] VNPay signData string:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521223859&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=DH20250521223859167&vnp_Version=2.1.0

[2025-05-21 22:38:59] VNPay generated signature:
c02d73178cc9cdb756e0563ad787ff75cc63657e978bbfe0c55b8809d5234acd6b8d069c843761dd9b9eddc8bb9ea4b25db76c0d88161192e69969cd0846f6bb

[2025-05-21 22:38:59] VNPay payment URL:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521223859&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=DH20250521223859167&vnp_Version=2.1.0&vnp_SecureHash=c02d73178cc9cdb756e0563ad787ff75cc63657e978bbfe0c55b8809d5234acd6b8d069c843761dd9b9eddc8bb9ea4b25db76c0d88161192e69969cd0846f6bb

[2025-05-21 22:38:59] Updated payment record with reference_id:
{
  "paymentId": 241,
  "orderId": "DH20250521223859167",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:38:59] === CREATE VNPAY PAYMENT - SUCCESS ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521223859&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=DH20250521223859167&vnp_Version=2.1.0&vnp_SecureHash=c02d73178cc9cdb756e0563ad787ff75cc63657e978bbfe0c55b8809d5234acd6b8d069c843761dd9b9eddc8bb9ea4b25db76c0d88161192e69969cd0846f6bb"
}

[2025-05-21 22:42:03] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "Y6UBDNQFBRYVOV3XDG3WQKQL12UB31XG",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:42:06] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:42:35] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:42:38] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:43:25] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:43:30] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:44:04] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:44:08] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:44:40] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "167",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:44:40] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "167"
}

[2025-05-21 22:44:40] Đã tạo bản ghi thanh toán:
{
  "paymentId": 242,
  "bookingId": "167",
  "amount": 4800000
}

[2025-05-21 22:44:40] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:44:40] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 22:44:40] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521224440167",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521224440",
  "vnp_BankCode": "NCB"
}

[2025-05-21 22:44:40] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521224440&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521224440167&vnp_Version=2.1.0

[2025-05-21 22:44:40] Chữ ký VNPay đã tạo:
5fe8b318f1615e30ebf2820d38e5aabf5fe5ab5b5da1da1aba6acfdd405d421e95b3c3a6a696256833922a3aaaa07f9330854902e2baee32dfeb24cc261a3225

[2025-05-21 22:44:40] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521224440&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521224440167&vnp_Version=2.1.0&vnp_SecureHash=5fe8b318f1615e30ebf2820d38e5aabf5fe5ab5b5da1da1aba6acfdd405d421e95b3c3a6a696256833922a3aaaa07f9330854902e2baee32dfeb24cc261a3225

[2025-05-21 22:44:40] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 242,
  "orderId": "20250521224440167",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 22:44:40] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521224440&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521224440167&vnp_Version=2.1.0&vnp_SecureHash=5fe8b318f1615e30ebf2820d38e5aabf5fe5ab5b5da1da1aba6acfdd405d421e95b3c3a6a696256833922a3aaaa07f9330854902e2baee32dfeb24cc261a3225"
}

[2025-05-21 22:50:02] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:02] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:02] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:02] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:02] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:02] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:02] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:05] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:05] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:05] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:05] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:05] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:05] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:05] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:06] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:06] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:06] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:06] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:06] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:06] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:06] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:22] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:22] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:22] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:22] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:22] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:22] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:22] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:22] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:22] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:22] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:22] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:22] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:22] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:22] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:24] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:24] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:24] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:24] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:24] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:24] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:24] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:24] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:24] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:24] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:24] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:24] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:24] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:24] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:24] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:24] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:24] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:24] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:24] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:24] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:24] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:50:25] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:50:25] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:50:25] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:50:25] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:50:25] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:50:25] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:50:25] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:53:59] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:53:59] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:53:59] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:53:59] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:53:59] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:53:59] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:53:59] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:54:01] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 22:54:01] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 22:54:01] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 22:54:01] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 22:54:01] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 22:54:01] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 22:54:01] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 22:55:52] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:56:59] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:57:25] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 22:57:29] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 23:00:28] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 23:00:28] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 23:00:28] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 23:00:28] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 23:00:28] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'paid_at' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:528:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:00:28] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:00:28] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:00:36] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971718",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521224623",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971718",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521224440167",
    "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
  },
  "ip": "::1"
}

[2025-05-21 23:00:36] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971718",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521224623",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971718",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521224440167",
  "vnp_SecureHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615"
}

[2025-05-21 23:00:36] Xác minh trả về:
{
  "receivedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "calculatedHash": "a27513abcd39c5b36d0bf00e21d86573b5d3fff622adde8762b2472a6b9d61ffc46e80f6c25c110ddbfaa5093c11ce821f310c1ffaf1f8d9c9054a72c374f615",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971718&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521224623&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971718&vnp_TransactionStatus=00&vnp_TxnRef=20250521224440167"
}

[2025-05-21 23:00:36] Thanh toán thành công
{
  "orderId": "20250521224440167",
  "amount": 4800000
}

[2025-05-21 23:00:36] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'paid_at' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:528:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:00:36] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:00:36] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:00:50] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "167",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:00:50] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "167"
}

[2025-05-21 23:00:50] Đã tạo bản ghi thanh toán:
{
  "paymentId": 243,
  "bookingId": "167",
  "amount": 4800000
}

[2025-05-21 23:00:50] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:00:50] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:00:50] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521230050167",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521230050",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:00:50] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230050&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230050167&vnp_Version=2.1.0

[2025-05-21 23:00:50] Chữ ký VNPay đã tạo:
c4f2aa200d9020fa72bf0a6d64ebc83d4e13e84be80452476d1bb4f553ca6c893cd3316e3bfa16518e1b7901de6ae38d013dfd24075437a4fcda7fedf0efaa85

[2025-05-21 23:00:50] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230050&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230050167&vnp_Version=2.1.0&vnp_SecureHash=c4f2aa200d9020fa72bf0a6d64ebc83d4e13e84be80452476d1bb4f553ca6c893cd3316e3bfa16518e1b7901de6ae38d013dfd24075437a4fcda7fedf0efaa85

[2025-05-21 23:00:50] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 243,
  "orderId": "20250521230050167",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:00:50] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230050&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230050167&vnp_Version=2.1.0&vnp_SecureHash=c4f2aa200d9020fa72bf0a6d64ebc83d4e13e84be80452476d1bb4f553ca6c893cd3316e3bfa16518e1b7901de6ae38d013dfd24075437a4fcda7fedf0efaa85"
}

[2025-05-21 23:02:23] VNPay Configuration:
{
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_HashSecret": "CCO21KBSH3AZNGQAQO7YT9K1V0X88NEV",
  "vnp_Url": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-ipn"
}

[2025-05-21 23:08:24] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "167",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:08:24] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "167"
}

[2025-05-21 23:08:24] Đã tạo bản ghi thanh toán:
{
  "paymentId": 244,
  "bookingId": "167",
  "amount": 4800000
}

[2025-05-21 23:08:24] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:24] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:08:24] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521230824167",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521230824",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:08:24] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230824&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230824167&vnp_Version=2.1.0

[2025-05-21 23:08:24] Chữ ký VNPay đã tạo:
3b1dd673f6ae88ecd3561842f71eb435259eb2274122bd4479fab54c4e8c36d412df3cc019b0d75ba492508ba9f219713d7c5b1f3f6fd9ba0aec4bd62dcd93dd

[2025-05-21 23:08:24] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230824&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230824167&vnp_Version=2.1.0&vnp_SecureHash=3b1dd673f6ae88ecd3561842f71eb435259eb2274122bd4479fab54c4e8c36d412df3cc019b0d75ba492508ba9f219713d7c5b1f3f6fd9ba0aec4bd62dcd93dd

[2025-05-21 23:08:24] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 244,
  "orderId": "20250521230824167",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:08:24] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521230824&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521230824167&vnp_Version=2.1.0&vnp_SecureHash=3b1dd673f6ae88ecd3561842f71eb435259eb2274122bd4479fab54c4e8c36d412df3cc019b0d75ba492508ba9f219713d7c5b1f3f6fd9ba0aec4bd62dcd93dd"
}

[2025-05-21 23:08:40] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:40] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:40] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:40] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:40] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:40] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:40] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:43] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:43] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:43] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:43] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:43] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:43] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:43] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:44] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:44] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:44] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:44] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:44] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:44] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:44] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:44] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:44] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:44] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:44] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:44] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:44] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:44] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:45] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:45] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:45] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:45] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:45] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:45] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:45] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:45] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:45] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:45] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:45] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:45] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:45] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:45] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:46] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:46] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:46] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:46] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:46] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:46] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:46] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:46] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:46] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:46] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:46] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:46] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:46] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:46] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:47] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:47] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:47] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:47] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:47] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:47] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:47] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:08:47] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971745",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521230214",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971745",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521230050167",
    "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
  },
  "ip": "::1"
}

[2025-05-21 23:08:47] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971745",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521230214",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971745",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521230050167",
  "vnp_SecureHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f"
}

[2025-05-21 23:08:47] Xác minh trả về:
{
  "receivedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "calculatedHash": "5c812688a77d2709f05823f0d8d762d2daef3f7d4e14e7c4a9171b31bcf75d76107087a7e075d4c8caab6bb9746ded53d54c59bf704bef41f76ba18b4f811a9f",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971745&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521230214&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971745&vnp_TransactionStatus=00&vnp_TxnRef=20250521230050167"
}

[2025-05-21 23:08:47] Thanh toán thành công
{
  "orderId": "20250521230050167",
  "amount": 4800000
}

[2025-05-21 23:08:47] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:08:47] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:08:47] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:12:51] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "168",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:12:51] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "168"
}

[2025-05-21 23:12:51] Đã tạo bản ghi thanh toán:
{
  "paymentId": 246,
  "bookingId": "168",
  "amount": 4800000
}

[2025-05-21 23:12:51] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:12:51] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:12:51] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521231251168",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521231251",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:12:51] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231251&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231251168&vnp_Version=2.1.0

[2025-05-21 23:12:51] Chữ ký VNPay đã tạo:
4a4d257283404931cd070b2d1dc7ee87fffa0679ea037e2961dfe5cecc7fffcddfcf73440eb0850042d09ec3ceeb89c0878601c65330ba84fa0eca284c4b979f

[2025-05-21 23:12:51] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231251&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231251168&vnp_Version=2.1.0&vnp_SecureHash=4a4d257283404931cd070b2d1dc7ee87fffa0679ea037e2961dfe5cecc7fffcddfcf73440eb0850042d09ec3ceeb89c0878601c65330ba84fa0eca284c4b979f

[2025-05-21 23:12:51] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 246,
  "orderId": "20250521231251168",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:12:51] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231251&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231251168&vnp_Version=2.1.0&vnp_SecureHash=4a4d257283404931cd070b2d1dc7ee87fffa0679ea037e2961dfe5cecc7fffcddfcf73440eb0850042d09ec3ceeb89c0878601c65330ba84fa0eca284c4b979f"
}

[2025-05-21 23:13:12] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "168",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:13:12] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "168"
}

[2025-05-21 23:13:12] Đã tạo bản ghi thanh toán:
{
  "paymentId": 247,
  "bookingId": "168",
  "amount": 4800000
}

[2025-05-21 23:13:12] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:13:12] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:13:12] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521231312168",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521231312",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:13:12] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231312&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231312168&vnp_Version=2.1.0

[2025-05-21 23:13:12] Chữ ký VNPay đã tạo:
5ff9e59d42d438e696e385a3b46d13e67fc0b8fe7e618b091106d39f2e3130c1b0d06a6bc2c3c5b52a8aa7757e28131d360a9a35c5027303b5858708c152c96d

[2025-05-21 23:13:12] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231312&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231312168&vnp_Version=2.1.0&vnp_SecureHash=5ff9e59d42d438e696e385a3b46d13e67fc0b8fe7e618b091106d39f2e3130c1b0d06a6bc2c3c5b52a8aa7757e28131d360a9a35c5027303b5858708c152c96d

[2025-05-21 23:13:12] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 247,
  "orderId": "20250521231312168",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:13:12] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231312&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231312168&vnp_Version=2.1.0&vnp_SecureHash=5ff9e59d42d438e696e385a3b46d13e67fc0b8fe7e618b091106d39f2e3130c1b0d06a6bc2c3c5b52a8aa7757e28131d360a9a35c5027303b5858708c152c96d"
}

[2025-05-21 23:14:25] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971768",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521231435",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971768",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521231312168",
    "vnp_SecureHash": "9e27022dfe61947d427a5ec60259aca2b2044ce4b69ef209a204532a68ec35443d43393c44f51b2f067736f0ad4da444d65e9d52966a343029e081d5d1eaff5d"
  },
  "ip": "::1"
}

[2025-05-21 23:14:25] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971768",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521231435",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971768",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521231312168",
  "vnp_SecureHash": "9e27022dfe61947d427a5ec60259aca2b2044ce4b69ef209a204532a68ec35443d43393c44f51b2f067736f0ad4da444d65e9d52966a343029e081d5d1eaff5d"
}

[2025-05-21 23:14:25] Xác minh trả về:
{
  "receivedHash": "9e27022dfe61947d427a5ec60259aca2b2044ce4b69ef209a204532a68ec35443d43393c44f51b2f067736f0ad4da444d65e9d52966a343029e081d5d1eaff5d",
  "calculatedHash": "9e27022dfe61947d427a5ec60259aca2b2044ce4b69ef209a204532a68ec35443d43393c44f51b2f067736f0ad4da444d65e9d52966a343029e081d5d1eaff5d",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971768&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521231435&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971768&vnp_TransactionStatus=00&vnp_TxnRef=20250521231312168"
}

[2025-05-21 23:14:25] Thanh toán thành công
{
  "orderId": "20250521231312168",
  "amount": 4800000
}

[2025-05-21 23:14:25] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:14:25] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:14:25] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:16:28] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "168",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:16:28] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "168"
}

[2025-05-21 23:16:28] Đã tạo bản ghi thanh toán:
{
  "paymentId": 248,
  "bookingId": "168",
  "amount": 4800000
}

[2025-05-21 23:16:28] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:16:28] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:16:28] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521231628168",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521231628",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:16:28] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231628&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231628168&vnp_Version=2.1.0

[2025-05-21 23:16:28] Chữ ký VNPay đã tạo:
209f5adcda928ed9ecd079f81bcd006c2f1011ea08e56b9e8a8751c66996c9d61f0823665f571af5de4e6f45f0daef43cdcb957b745ee36ba613e962194c5047

[2025-05-21 23:16:28] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231628&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231628168&vnp_Version=2.1.0&vnp_SecureHash=209f5adcda928ed9ecd079f81bcd006c2f1011ea08e56b9e8a8751c66996c9d61f0823665f571af5de4e6f45f0daef43cdcb957b745ee36ba613e962194c5047

[2025-05-21 23:16:28] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 248,
  "orderId": "20250521231628168",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:16:28] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521231628&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521231628168&vnp_Version=2.1.0&vnp_SecureHash=209f5adcda928ed9ecd079f81bcd006c2f1011ea08e56b9e8a8751c66996c9d61f0823665f571af5de4e6f45f0daef43cdcb957b745ee36ba613e962194c5047"
}

[2025-05-21 23:17:15] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971774",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521231733",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971774",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521231628168",
    "vnp_SecureHash": "84c8588dd4d54adff848739e8da77270478fcee37efa9c7e973d627ad00423c442b703991a24ed051d563fe54d70d46a0165cc77b6fcd2ed8ca07fdd2dca13c8"
  },
  "ip": "::1"
}

[2025-05-21 23:17:15] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971774",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521231733",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971774",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521231628168",
  "vnp_SecureHash": "84c8588dd4d54adff848739e8da77270478fcee37efa9c7e973d627ad00423c442b703991a24ed051d563fe54d70d46a0165cc77b6fcd2ed8ca07fdd2dca13c8"
}

[2025-05-21 23:17:15] Xác minh trả về:
{
  "receivedHash": "84c8588dd4d54adff848739e8da77270478fcee37efa9c7e973d627ad00423c442b703991a24ed051d563fe54d70d46a0165cc77b6fcd2ed8ca07fdd2dca13c8",
  "calculatedHash": "84c8588dd4d54adff848739e8da77270478fcee37efa9c7e973d627ad00423c442b703991a24ed051d563fe54d70d46a0165cc77b6fcd2ed8ca07fdd2dca13c8",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971774&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521231733&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971774&vnp_TransactionStatus=00&vnp_TxnRef=20250521231628168"
}

[2025-05-21 23:17:15] Thanh toán thành công
{
  "orderId": "20250521231628168",
  "amount": 4800000
}

[2025-05-21 23:17:15] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:17:15] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:17:15] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:32:04] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "480000000",
    "vnp_BankCode": "VNPAY",
    "vnp_CardType": "QRCODE",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
    "vnp_PayDate": "20250521231659",
    "vnp_ResponseCode": "15",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "0",
    "vnp_TransactionStatus": "02",
    "vnp_TxnRef": "20250521231628168",
    "vnp_SecureHash": "978ef99f23134bf832c6c76ed512df5278372e7a6b674e829cb94f1a7731fee6e0b6b9569bf8c573a0dafbc6c9de843834e8805abe0acec7a76637bdb51d8e83"
  },
  "ip": "::1"
}

[2025-05-21 23:32:04] Tham số trả về:
{
  "vnp_Amount": "480000000",
  "vnp_BankCode": "VNPAY",
  "vnp_CardType": "QRCODE",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_PayDate": "20250521231659",
  "vnp_ResponseCode": "15",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "0",
  "vnp_TransactionStatus": "02",
  "vnp_TxnRef": "20250521231628168",
  "vnp_SecureHash": "978ef99f23134bf832c6c76ed512df5278372e7a6b674e829cb94f1a7731fee6e0b6b9569bf8c573a0dafbc6c9de843834e8805abe0acec7a76637bdb51d8e83"
}

[2025-05-21 23:32:04] Xác minh trả về:
{
  "receivedHash": "978ef99f23134bf832c6c76ed512df5278372e7a6b674e829cb94f1a7731fee6e0b6b9569bf8c573a0dafbc6c9de843834e8805abe0acec7a76637bdb51d8e83",
  "calculatedHash": "978ef99f23134bf832c6c76ed512df5278372e7a6b674e829cb94f1a7731fee6e0b6b9569bf8c573a0dafbc6c9de843834e8805abe0acec7a76637bdb51d8e83",
  "queryString": "vnp_Amount=480000000&vnp_BankCode=VNPAY&vnp_CardType=QRCODE&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_PayDate=20250521231659&vnp_ResponseCode=15&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=0&vnp_TransactionStatus=02&vnp_TxnRef=20250521231628168"
}

[2025-05-21 23:32:04] Thanh toán thất bại
{
  "orderId": "20250521231628168",
  "responseCode": "15",
  "message": "Giao dịch không thành công"
}

[2025-05-21 23:32:04] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán thất bại:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:584:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:32:04] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:32:04] Chuyển hướng đến:
parkingapp://payment-result?status=failed&message=Giao%20d%E1%BB%8Bch%20kh%C3%B4ng%20th%C3%A0nh%20c%C3%B4ng&amount=4800000

[2025-05-21 23:32:06] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "168",
  "amount": 4800000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:32:06] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "168"
}

[2025-05-21 23:32:06] Đã tạo bản ghi thanh toán:
{
  "paymentId": 249,
  "bookingId": "168",
  "amount": 4800000
}

[2025-05-21 23:32:06] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:32:06] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:32:06] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521233206168",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-21",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "480000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521233206",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:32:06] Chuỗi dữ liệu signData VNPay:
vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233206&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233206168&vnp_Version=2.1.0

[2025-05-21 23:32:06] Chữ ký VNPay đã tạo:
a584fd1d522a59e83c1c77a7796e488c309cdea7ac67f57c6834ff8650b2af6efa280d2792f3e327c8de3dbf8f94bd06af47d4d2c1c9bb14719bb936ad9bc57b

[2025-05-21 23:32:06] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233206&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233206168&vnp_Version=2.1.0&vnp_SecureHash=a584fd1d522a59e83c1c77a7796e488c309cdea7ac67f57c6834ff8650b2af6efa280d2792f3e327c8de3dbf8f94bd06af47d4d2c1c9bb14719bb936ad9bc57b

[2025-05-21 23:32:06] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 249,
  "orderId": "20250521233206168",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:32:06] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=480000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233206&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-21&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233206168&vnp_Version=2.1.0&vnp_SecureHash=a584fd1d522a59e83c1c77a7796e488c309cdea7ac67f57c6834ff8650b2af6efa280d2792f3e327c8de3dbf8f94bd06af47d4d2c1c9bb14719bb936ad9bc57b"
}

[2025-05-21 23:34:18] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "169",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:34:18] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "169"
}

[2025-05-21 23:34:18] Đã tạo bản ghi thanh toán:
{
  "paymentId": 251,
  "bookingId": "169",
  "amount": 180000
}

[2025-05-21 23:34:18] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:34:18] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:34:18] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521233418169",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "18000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521233418",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:34:18] Chuỗi dữ liệu signData VNPay:
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233418&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233418169&vnp_Version=2.1.0

[2025-05-21 23:34:18] Chữ ký VNPay đã tạo:
e43302ddcda9a298f370fe8aca456522c917c4f4f25b2dbc729ca89f5140ddaaba545d1bff57e250153161f8ff9de69c5cf134cad6b93996a4ac350d7432313d

[2025-05-21 23:34:18] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233418&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233418169&vnp_Version=2.1.0&vnp_SecureHash=e43302ddcda9a298f370fe8aca456522c917c4f4f25b2dbc729ca89f5140ddaaba545d1bff57e250153161f8ff9de69c5cf134cad6b93996a4ac350d7432313d

[2025-05-21 23:34:18] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 251,
  "orderId": "20250521233418169",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:34:18] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233418&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233418169&vnp_Version=2.1.0&vnp_SecureHash=e43302ddcda9a298f370fe8aca456522c917c4f4f25b2dbc729ca89f5140ddaaba545d1bff57e250153161f8ff9de69c5cf134cad6b93996a4ac350d7432313d"
}

[2025-05-21 23:35:14] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "18000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971806",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
    "vnp_PayDate": "20250521233538",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971806",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521233418169",
    "vnp_SecureHash": "0ae0dc9b1e70f4e19757440b8ef63123eafce96dc5f3ff2e0e8ea2766a7981845e8e0993be3bbdfe69afe7bc961eeb39496574f56de35b06b5f181bcb7fcd6b2"
  },
  "ip": "::1"
}

[2025-05-21 23:35:14] Tham số trả về:
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971806",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_PayDate": "20250521233538",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971806",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521233418169",
  "vnp_SecureHash": "0ae0dc9b1e70f4e19757440b8ef63123eafce96dc5f3ff2e0e8ea2766a7981845e8e0993be3bbdfe69afe7bc961eeb39496574f56de35b06b5f181bcb7fcd6b2"
}

[2025-05-21 23:35:14] Xác minh trả về:
{
  "receivedHash": "0ae0dc9b1e70f4e19757440b8ef63123eafce96dc5f3ff2e0e8ea2766a7981845e8e0993be3bbdfe69afe7bc961eeb39496574f56de35b06b5f181bcb7fcd6b2",
  "calculatedHash": "0ae0dc9b1e70f4e19757440b8ef63123eafce96dc5f3ff2e0e8ea2766a7981845e8e0993be3bbdfe69afe7bc961eeb39496574f56de35b06b5f181bcb7fcd6b2",
  "queryString": "vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971806&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_PayDate=20250521233538&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971806&vnp_TransactionStatus=00&vnp_TxnRef=20250521233418169"
}

[2025-05-21 23:35:14] Thanh toán thành công
{
  "orderId": "20250521233418169",
  "amount": 180000
}

[2025-05-21 23:35:14] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'response_code' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:35:14] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:35:14] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=180000

[2025-05-21 23:38:01] === YÊU CẦU TẠO THANH TOÁN VNPAY ===
{
  "bookingId": "169",
  "amount": 180000,
  "orderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:38:01] Kết quả kiểm tra đặt chỗ:
{
  "found": true,
  "bookingId": "169"
}

[2025-05-21 23:38:01] Đã tạo bản ghi thanh toán:
{
  "paymentId": 252,
  "bookingId": "169",
  "amount": 180000
}

[2025-05-21 23:38:01] Phát hiện URL trả về từ ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:38:01] URL trả về được sử dụng cho VNPay:
https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return

[2025-05-21 23:38:01] Tham số gốc VNPay:
{
  "vnp_Version": "2.1.0",
  "vnp_Command": "pay",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_Locale": "vn",
  "vnp_CurrCode": "VND",
  "vnp_TxnRef": "20250521233801169",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_OrderType": "billpayment",
  "vnp_Amount": "18000000",
  "vnp_ReturnUrl": "https://f613-113-22-46-72.ngrok-free.app/api/payment/vnpay-return",
  "vnp_IpAddr": "192.168.0.100",
  "vnp_CreateDate": "20250521233801",
  "vnp_BankCode": "NCB"
}

[2025-05-21 23:38:01] Chuỗi dữ liệu signData VNPay:
vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233801&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233801169&vnp_Version=2.1.0

[2025-05-21 23:38:01] Chữ ký VNPay đã tạo:
c797fcf8a3955b3aa596aa244b57a4d770db9b460d5bd87000d62a4bab457f4d9b66ad1ff50bb08ed6ef1a69b665d7c1be83fd7347a82b9fe374ee51c1260646

[2025-05-21 23:38:01] URL thanh toán VNPay:
https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233801&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233801169&vnp_Version=2.1.0&vnp_SecureHash=c797fcf8a3955b3aa596aa244b57a4d770db9b460d5bd87000d62a4bab457f4d9b66ad1ff50bb08ed6ef1a69b665d7c1be83fd7347a82b9fe374ee51c1260646

[2025-05-21 23:38:01] Cập nhật bản ghi thanh toán với reference_id:
{
  "paymentId": 252,
  "orderId": "20250521233801169",
  "returnUrl": "parkingapp://payment-result"
}

[2025-05-21 23:38:01] === TẠO THANH TOÁN VNPAY THÀNH CÔNG ===
{
  "paymentUrl": "https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?vnp_Amount=18000000&vnp_BankCode=NCB&vnp_Command=pay&vnp_CreateDate=20250521233801&vnp_CurrCode=VND&vnp_IpAddr=192.168.0.100&vnp_Locale=vn&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_OrderType=billpayment&vnp_ReturnUrl=https%3A%2F%2Ff613-113-22-46-72.ngrok-free.app%2Fapi%2Fpayment%2Fvnpay-return&vnp_TmnCode=BXG8SRK8&vnp_TxnRef=20250521233801169&vnp_Version=2.1.0&vnp_SecureHash=c797fcf8a3955b3aa596aa244b57a4d770db9b460d5bd87000d62a4bab457f4d9b66ad1ff50bb08ed6ef1a69b665d7c1be83fd7347a82b9fe374ee51c1260646"
}

[2025-05-21 23:38:43] === XỬ LÝ CALLBACK TRẢ VỀ TỪ VNPAY ===
{
  "query": {
    "vnp_Amount": "18000000",
    "vnp_BankCode": "NCB",
    "vnp_BankTranNo": "VNP14971810",
    "vnp_CardType": "ATM",
    "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
    "vnp_PayDate": "20250521233905",
    "vnp_ResponseCode": "00",
    "vnp_TmnCode": "BXG8SRK8",
    "vnp_TransactionNo": "14971810",
    "vnp_TransactionStatus": "00",
    "vnp_TxnRef": "20250521233801169",
    "vnp_SecureHash": "1f0be9fd92c7fdf53f184ebf43468e0bcba31b02b5369f08eca8f7fe1295153a00e11898af798991cb386b634c366ccf4100805c330f059933f34eb2ea63e02d"
  },
  "ip": "::1"
}

[2025-05-21 23:38:43] Tham số trả về:
{
  "vnp_Amount": "18000000",
  "vnp_BankCode": "NCB",
  "vnp_BankTranNo": "VNP14971810",
  "vnp_CardType": "ATM",
  "vnp_OrderInfo": "Thanh toán đặt chỗ K11 - 2025-05-22",
  "vnp_PayDate": "20250521233905",
  "vnp_ResponseCode": "00",
  "vnp_TmnCode": "BXG8SRK8",
  "vnp_TransactionNo": "14971810",
  "vnp_TransactionStatus": "00",
  "vnp_TxnRef": "20250521233801169",
  "vnp_SecureHash": "1f0be9fd92c7fdf53f184ebf43468e0bcba31b02b5369f08eca8f7fe1295153a00e11898af798991cb386b634c366ccf4100805c330f059933f34eb2ea63e02d"
}

[2025-05-21 23:38:43] Xác minh trả về:
{
  "receivedHash": "1f0be9fd92c7fdf53f184ebf43468e0bcba31b02b5369f08eca8f7fe1295153a00e11898af798991cb386b634c366ccf4100805c330f059933f34eb2ea63e02d",
  "calculatedHash": "1f0be9fd92c7fdf53f184ebf43468e0bcba31b02b5369f08eca8f7fe1295153a00e11898af798991cb386b634c366ccf4100805c330f059933f34eb2ea63e02d",
  "queryString": "vnp_Amount=18000000&vnp_BankCode=NCB&vnp_BankTranNo=VNP14971810&vnp_CardType=ATM&vnp_OrderInfo=Thanh+to%C3%A1n+%C4%91%E1%BA%B7t+ch%E1%BB%97+K11+-+2025-05-22&vnp_PayDate=20250521233905&vnp_ResponseCode=00&vnp_TmnCode=BXG8SRK8&vnp_TransactionNo=14971810&vnp_TransactionStatus=00&vnp_TxnRef=20250521233801169"
}

[2025-05-21 23:38:43] Thanh toán thành công
{
  "orderId": "20250521233801169",
  "amount": 180000
}

[2025-05-21 23:38:43] Lỗi cơ sở dữ liệu khi cập nhật trạng thái thanh toán:
Error: Unknown column 'transaction_ref' in 'field list'
    at PromisePool.query (D:\Parking\backend\danentang\backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at vnpayReturn (D:\Parking\backend\danentang\backend\controllers\paymentController.js:529:22)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)

[2025-05-21 23:38:43] Tìm thấy URL trả về cho ứng dụng di động:
parkingapp://payment-result

[2025-05-21 23:38:43] Chuyển hướng đến:
parkingapp://payment-result?status=success&message=Thanh%20to%C3%A1n%20th%C3%A0nh%20c%C3%B4ng&amount=180000
